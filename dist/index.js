!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var s in r)("object"==typeof exports?exports:e)[s]=r[s]}}(window,function(){return function(e){var t={};function r(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(s,o,function(t){return e[t]}.bind(null,o));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class s{static parse(e){let t=[];return t=s.getParts(e,t,s.isBemBlock(e),s.getBlockParam),t=s.getParts(e,t,s.isBemModifier(e),s.getModifierParam)}static isBemBlock(e){return!!e.match(s.BLOCK_PATTERN)}static isBemModifier(e){return!!e.match(s.MODIFIER_PATTERN)}static getParts(e,t,r,s){if(!r)return t;return e.split(".").filter(Boolean).forEach(e=>{(e=s(e))&&!t.includes(e)&&t.push(e)}),t}static getBlockParam(e){const t=/\S+?(?=__)/g;return e.match(t)&&"."+e.match(t)[0]+" *"}static getModifierParam(e){const t=/\S+?(?=--)/g;return e.match(t)&&"."+e.match(t)[0]}}s.BLOCK_PATTERN=/\S+__\S+/g,s.MODIFIER_PATTERN=/\S+--\S+/g,t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(2),o=r(3),i=e=>new o.default(e.stylesheet.rules).resolve();t.preprocess=((e,t)=>(e.stylesheet.rules=i(e),t())),t.processLint=(e=>(e.stylesheet.rules=i(e),s.lint(e))),t.name="BEM"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(0);t.lint=(e=>{const{rules:t,isBemDetected:r}=o(e);return{isBemDetected:r,isValid:r&&0===t.length,rules:t.map(({rule:e,className:t})=>({missingClassName:t,selector:e.selectors[0]||""}))}});const o=e=>{const t=[],r=[],s=[],o=[];return e.stylesheet.rules.forEach(e=>{i(e,t,r,s,o),"media"===e.type&&e.rules.forEach(e=>{i(e,t,r,s,o)})}),{rules:[...new Set(t)],isBemDetected:o.length>0}},i=(e,t,r,o,i)=>{if("rule"===e.type){const n=e.selectors[0],l=[...new Set([].concat(...n.split(".")).filter(e=>e).map(e=>`.${e}`))];o.push(...l),e.declarations.forEach(l=>{if("x-should"===l.property){i.push(n);const a=l.value.match(/(?=\.)(.*)(?=')/g)[0].match(/(\.\S+)/g)[0];if(((e,t,r)=>t.includes(r))(0,o,a))return;if(s.default.isBemModifier(n)&&s.default.isBemBlock(a)){const s=new RegExp(a,"g");if(n.match(s).length<=1)return r.push(a),void t.push({className:a,rule:e})}if(s.default.isBemBlock(n)&&!s.default.isBemModifier(a)&&!s.default.isBemBlock(a))return r.push(a),void t.push({className:a,rule:e});if(s.default.isBemModifier(n))return r.push(a),void t.push({className:a,rule:e})}})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(0);class o{constructor(e){this.rules=e}static isNotMediaQuery(e){return"media"!==e.type}static isRule(e){return"rule"===e.type}static isCssClass(e){return!!e.match(/(\.\S+)/g)}static removeInvalidMatches(e){return e.filter(e=>!e.match(/\[.+/g))}static getLastPartOfCssClass(e){return"."+e.split(".").filter(Boolean).pop()}resolve(){const e=[];return this.rules.forEach(t=>{if(o.isNotMediaQuery(t)&&o.isRule(t)){this.flattenRules([t]).map(t=>e.push(this.getRuleWithBemDeclarations(t)))}else t.rules=this.flattenRules(t.rules),t.rules=t.rules.map(e=>this.getRuleWithBemDeclarations(e)),e.push(t)}),e}flattenRules(e){const t=[];return e?(e.forEach(e=>{e.selectors&&e.selectors.forEach(r=>{const s={declarations:e.declarations,position:e.position,selectors:[r],type:e.type};t.push(s)})}),t):t}getRuleWithBemDeclarations(e){const t=[];if(e.selectors.forEach(e=>{o.isCssClass(e)&&(e=o.getLastPartOfCssClass(e),t.push(e))}),t.length<1)return e;let r=s.default.parse(t[0]);return(r=o.removeInvalidMatches(r))?(e.declarations=e.declarations.concat(r.map(e=>({type:"declaration",property:"x-should",value:`match '${e}'`}))),e):e}}t.default=o}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly8vLi9zcmMvQmVtUGFyc2VyLnRzIiwid2VicGFjazovLy8uL3NyYy9pbmRleC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbGludC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvUnVsZXNSZXNvbHZlci50cyJdLCJuYW1lcyI6WyJyb290IiwiZmFjdG9yeSIsImV4cG9ydHMiLCJtb2R1bGUiLCJkZWZpbmUiLCJhbWQiLCJhIiwiaSIsIndpbmRvdyIsImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIkJlbVBhcnNlciIsIltvYmplY3QgT2JqZWN0XSIsImNsYXNzTmFtZSIsInBhcnRzIiwiZ2V0UGFydHMiLCJpc0JlbUJsb2NrIiwiZ2V0QmxvY2tQYXJhbSIsImlzQmVtTW9kaWZpZXIiLCJnZXRNb2RpZmllclBhcmFtIiwibWF0Y2giLCJCTE9DS19QQVRURVJOIiwiTU9ESUZJRVJfUEFUVEVSTiIsInNob3VsZEJlUGFydE9mIiwiYmVtVHlwZSIsImdldFBhcmFtIiwic3BsaXQiLCJmaWx0ZXIiLCJCb29sZWFuIiwiZm9yRWFjaCIsInBhcnQiLCJpbmNsdWRlcyIsInB1c2giLCJibG9ja1BhdHRlcm4iLCJtb2RpZmllclBhdHRlcm4iLCJkZWZhdWx0IiwibGludF8xIiwiUnVsZXNSZXNvbHZlcl8xIiwicHJvY2VzcyIsImN0eCIsInN0eWxlc2hlZXQiLCJydWxlcyIsInJlc29sdmUiLCJwcmVwcm9jZXNzIiwibmV4dCIsInByb2Nlc3NMaW50IiwibGludCIsIkJlbVBhcnNlcl8xIiwiY3NzIiwiaXNCZW1EZXRlY3RlZCIsImdldEludmFsaWRSdWxlcyIsImlzVmFsaWQiLCJsZW5ndGgiLCJtYXAiLCJydWxlIiwibWlzc2luZ0NsYXNzTmFtZSIsInNlbGVjdG9yIiwic2VsZWN0b3JzIiwiaW52YWxpZFJ1bGVzIiwiaW52YWxpZENsYXNzTmFtZXMiLCJiZW1TZWxlY3RvcnMiLCJkZXRlY3RNaXNzaW5nQ2xhc3NlcyIsInR5cGUiLCJpdGVtIiwiU2V0IiwiYWxsU2VsZWN0b3JzIiwiY29uY2F0IiwiZGVjbGFyYXRpb25zIiwiZGVjbGFyYXRpb24iLCJpc0NsYXNzTmFtZUV4aXN0SW5Db2xsZWN0aW9uIiwicmVnZXgiLCJSZWdFeHAiLCJSdWxlc1Jlc29sdmVyIiwidGhpcyIsIm1hdGNoZXMiLCJwb3AiLCJyZXN1bHQiLCJpc05vdE1lZGlhUXVlcnkiLCJpc1J1bGUiLCJmbGF0dGVuUnVsZXMiLCJnZXRSdWxlV2l0aEJlbURlY2xhcmF0aW9ucyIsInJlc3VsdHMiLCJuZXdSdWxlIiwicG9zaXRpb24iLCJzZWxlY3RvcnNXaXRoQ3NzQ2xhc3MiLCJpc0Nzc0NsYXNzIiwiZ2V0TGFzdFBhcnRPZkNzc0NsYXNzIiwicGFyYW1zIiwicGFyc2UiLCJyZW1vdmVJbnZhbGlkTWF0Y2hlcyIsInBhcmFtIl0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFBQSxFQUFBQyxHQUNBLG9CQUFBQyxTQUFBLGlCQUFBQyxPQUNBQSxPQUFBRCxRQUFBRCxTQUNBLHNCQUFBRyxlQUFBQyxJQUNBRCxPQUFBLEdBQUFILE9BQ0EsQ0FDQSxJQUFBSyxFQUFBTCxJQUNBLFFBQUFNLEtBQUFELEdBQUEsaUJBQUFKLGdCQUFBRixHQUFBTyxHQUFBRCxFQUFBQyxJQVBBLENBU0ND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VCxJQUFJaUMsRUFBbUJ4QyxFQUFBWixRQUFVcUQsTUFBTUosRUFBc0IsSUFJN0QsT0FGQUcsRUFBU2YsRUFBY2lCLHFCQUFxQkYsS0FNNUNqQyxFQUFLYSxhQUFlYixFQUFLYSxhQUFhRCxPQUNwQ3FCLEVBQU9sQyxJQUNKcUMsSUFBK0IsQ0FBRzVCLEtBQU0sY0FBZXhELFNBQVUsV0FBWVYsZ0JBQWlCOEYsU0FJNUZwQyxHQVRFQSxHQXRHYnBGLEVBQUFpRSxRQUFBcUMiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXSwgZmFjdG9yeSk7XG5cdGVsc2Uge1xuXHRcdHZhciBhID0gZmFjdG9yeSgpO1xuXHRcdGZvcih2YXIgaSBpbiBhKSAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnID8gZXhwb3J0cyA6IHJvb3QpW2ldID0gYVtpXTtcblx0fVxufSkod2luZG93LCBmdW5jdGlvbigpIHtcbnJldHVybiAiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMSk7XG4iLCJpbXBvcnQgeyBDbGFzc05hbWVUeXBlIH0gZnJvbSAnLi9saW50JztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQmVtUGFyc2VyIHtcbiAgcHVibGljIHN0YXRpYyBwYXJzZShjbGFzc05hbWU6IENsYXNzTmFtZVR5cGUpOiBzdHJpbmdbXSB7XG4gICAgbGV0IHBhcnRzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgcGFydHMgPSBCZW1QYXJzZXIuZ2V0UGFydHMoY2xhc3NOYW1lLCBwYXJ0cywgQmVtUGFyc2VyLmlzQmVtQmxvY2soY2xhc3NOYW1lKSwgQmVtUGFyc2VyLmdldEJsb2NrUGFyYW0pO1xuICAgIHBhcnRzID0gQmVtUGFyc2VyLmdldFBhcnRzKGNsYXNzTmFtZSwgcGFydHMsIEJlbVBhcnNlci5pc0JlbU1vZGlmaWVyKGNsYXNzTmFtZSksIEJlbVBhcnNlci5nZXRNb2RpZmllclBhcmFtKTtcblxuICAgIHJldHVybiBwYXJ0cztcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgaXNCZW1CbG9jayhjbGFzc05hbWU6IENsYXNzTmFtZVR5cGUpOiBib29sZWFuIHtcbiAgICByZXR1cm4gISFjbGFzc05hbWUubWF0Y2goQmVtUGFyc2VyLkJMT0NLX1BBVFRFUk4pO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBpc0JlbU1vZGlmaWVyKGNsYXNzTmFtZTogQ2xhc3NOYW1lVHlwZSk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAhIWNsYXNzTmFtZS5tYXRjaChCZW1QYXJzZXIuTU9ESUZJRVJfUEFUVEVSTik7XG4gIH1cbiAgcHJpdmF0ZSBzdGF0aWMgQkxPQ0tfUEFUVEVSTjogUmVnRXhwID0gL1xcUytfX1xcUysvZztcbiAgcHJpdmF0ZSBzdGF0aWMgTU9ESUZJRVJfUEFUVEVSTjogUmVnRXhwID0gL1xcUystLVxcUysvZztcblxuICBwcml2YXRlIHN0YXRpYyBnZXRQYXJ0cyhcbiAgICBjbGFzc05hbWU6IENsYXNzTmFtZVR5cGUsXG4gICAgc2hvdWxkQmVQYXJ0T2Y6IHN0cmluZ1tdLFxuICAgIGJlbVR5cGU6IGJvb2xlYW4sXG4gICAgZ2V0UGFyYW06IChjbGFzc05hbWU6IENsYXNzTmFtZVR5cGUpID0+IHN0cmluZyxcbiAgKTogc3RyaW5nW10ge1xuICAgIGlmICghYmVtVHlwZSkge1xuICAgICAgcmV0dXJuIHNob3VsZEJlUGFydE9mO1xuICAgIH1cblxuICAgIGNvbnN0IHBhcnRzOiBzdHJpbmdbXSA9IGNsYXNzTmFtZS5zcGxpdCgnLicpLmZpbHRlcihCb29sZWFuKTtcblxuICAgIHBhcnRzLmZvckVhY2goKHBhcnQpID0+IHtcbiAgICAgIHBhcnQgPSBnZXRQYXJhbShwYXJ0KTtcblxuICAgICAgaWYgKHBhcnQgJiYgIXNob3VsZEJlUGFydE9mLmluY2x1ZGVzKHBhcnQpKSB7XG4gICAgICAgIHNob3VsZEJlUGFydE9mLnB1c2gocGFydCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gc2hvdWxkQmVQYXJ0T2Y7XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBnZXRCbG9ja1BhcmFtKGNsYXNzTmFtZTogQ2xhc3NOYW1lVHlwZSk6IHN0cmluZyB7XG4gICAgY29uc3QgYmxvY2tQYXR0ZXJuOiBSZWdFeHAgPSAvXFxTKz8oPz1fXykvZztcblxuICAgIHJldHVybiBjbGFzc05hbWUubWF0Y2goYmxvY2tQYXR0ZXJuKSAmJiAnLicgKyBjbGFzc05hbWUubWF0Y2goYmxvY2tQYXR0ZXJuKVswXSArICcgKic7XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBnZXRNb2RpZmllclBhcmFtKGNsYXNzTmFtZTogQ2xhc3NOYW1lVHlwZSk6IHN0cmluZyB7XG4gICAgY29uc3QgbW9kaWZpZXJQYXR0ZXJuOiBSZWdFeHAgPSAvXFxTKz8oPz0tLSkvZztcblxuICAgIHJldHVybiBjbGFzc05hbWUubWF0Y2gobW9kaWZpZXJQYXR0ZXJuKSAmJiAnLicgKyBjbGFzc05hbWUubWF0Y2gobW9kaWZpZXJQYXR0ZXJuKVswXTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgUnVsZSwgU3R5bGVzaGVldCB9IGZyb20gJ2Nzcyc7XG5pbXBvcnQgeyBJTWVkaWFRdWVyeSB9IGZyb20gJy4vSU1lZGlhUXVlcnknO1xuaW1wb3J0IHsgSUxpbnRSdWxlLCBsaW50IH0gZnJvbSAnLi9saW50JztcbmltcG9ydCBSdWxlc1Jlc29sdmVyIGZyb20gJy4vUnVsZXNSZXNvbHZlcic7XG5cbmNvbnN0IHByb2Nlc3MgPSAoY3R4OiBTdHlsZXNoZWV0KTogQXJyYXk8UnVsZSB8IElNZWRpYVF1ZXJ5PiA9PiBuZXcgUnVsZXNSZXNvbHZlcihjdHguc3R5bGVzaGVldC5ydWxlcykucmVzb2x2ZSgpO1xuXG5leHBvcnQgY29uc3QgcHJlcHJvY2VzcyA9IChjdHg6IFN0eWxlc2hlZXQsIG5leHQ6ICgpID0+IGFueSk6IGFueSA9PiB7XG4gIGN0eC5zdHlsZXNoZWV0LnJ1bGVzID0gcHJvY2VzcyhjdHgpO1xuXG4gIHJldHVybiBuZXh0KCk7XG59O1xuXG5leHBvcnQgY29uc3QgcHJvY2Vzc0xpbnQgPSAoY3R4OiBTdHlsZXNoZWV0KTogeyBydWxlczogSUxpbnRSdWxlW107IGlzVmFsaWQ6IGJvb2xlYW47IGlzQmVtRGV0ZWN0ZWQ6IGJvb2xlYW4gfSA9PiB7XG4gIGN0eC5zdHlsZXNoZWV0LnJ1bGVzID0gcHJvY2VzcyhjdHgpO1xuXG4gIHJldHVybiBsaW50KGN0eCk7XG59O1xuXG5leHBvcnQgY29uc3QgbmFtZTogc3RyaW5nID0gJ0JFTSc7XG4iLCJpbXBvcnQgeyBNZWRpYSwgUnVsZSwgU3R5bGVzaGVldCB9IGZyb20gJ2Nzcyc7XG5pbXBvcnQgQmVtUGFyc2VyIGZyb20gJy4vQmVtUGFyc2VyJztcbmltcG9ydCB7IElYU2hvdWxkRGVjbGFyYXRpb24gfSBmcm9tICcuL1J1bGVzUmVzb2x2ZXInO1xuXG5leHBvcnQgdHlwZSBDbGFzc05hbWVUeXBlID0gc3RyaW5nO1xudHlwZSBDbGFzc05hbWVzVHlwZSA9IENsYXNzTmFtZVR5cGVbXTtcbmV4cG9ydCB0eXBlIFNlbGVjdG9yVHlwZSA9IHN0cmluZztcbnR5cGUgU2VsZWN0b3JzVHlwZSA9IFNlbGVjdG9yVHlwZVtdO1xuZXhwb3J0IGludGVyZmFjZSBJTGludFJ1bGUge1xuICBtaXNzaW5nQ2xhc3NOYW1lOiBDbGFzc05hbWVUeXBlO1xuICBzZWxlY3RvcjogU2VsZWN0b3JUeXBlO1xufVxuXG5leHBvcnQgY29uc3QgbGludCA9IChjc3M6IFN0eWxlc2hlZXQpOiB7IHJ1bGVzOiBJTGludFJ1bGVbXTsgaXNWYWxpZDogYm9vbGVhbjsgaXNCZW1EZXRlY3RlZDogYm9vbGVhbiB9ID0+IHtcbiAgY29uc3QgeyBydWxlcywgaXNCZW1EZXRlY3RlZCB9ID0gZ2V0SW52YWxpZFJ1bGVzKGNzcyk7XG5cbiAgcmV0dXJuIHtcbiAgICBpc0JlbURldGVjdGVkLFxuICAgIGlzVmFsaWQ6IGlzQmVtRGV0ZWN0ZWQgJiYgcnVsZXMubGVuZ3RoID09PSAwLFxuICAgIHJ1bGVzOiBydWxlcy5tYXAoKHsgcnVsZSwgY2xhc3NOYW1lIH0pID0+ICh7XG4gICAgICBtaXNzaW5nQ2xhc3NOYW1lOiBjbGFzc05hbWUsXG4gICAgICBzZWxlY3RvcjogcnVsZS5zZWxlY3RvcnNbMF0gfHwgJycsXG4gICAgfSkpLFxuICB9O1xufTtcblxuY29uc3QgZ2V0SW52YWxpZFJ1bGVzID0gKFxuICBjc3M6IFN0eWxlc2hlZXQsXG4pOiB7IHJ1bGVzOiBBcnJheTx7IGNsYXNzTmFtZTogQ2xhc3NOYW1lVHlwZTsgcnVsZTogUnVsZSB9PjsgaXNCZW1EZXRlY3RlZDogYm9vbGVhbiB9ID0+IHtcbiAgY29uc3QgaW52YWxpZFJ1bGVzID0gW107XG4gIGNvbnN0IGludmFsaWRDbGFzc05hbWVzID0gW107XG4gIGNvbnN0IHNlbGVjdG9ycyA9IFtdO1xuICBjb25zdCBiZW1TZWxlY3RvcnMgPSBbXTtcblxuICBjc3Muc3R5bGVzaGVldC5ydWxlcy5mb3JFYWNoKChydWxlOiBSdWxlICYgTWVkaWEpID0+IHtcbiAgICBkZXRlY3RNaXNzaW5nQ2xhc3NlcyhydWxlLCBpbnZhbGlkUnVsZXMsIGludmFsaWRDbGFzc05hbWVzLCBzZWxlY3RvcnMsIGJlbVNlbGVjdG9ycyk7XG5cbiAgICBpZiAocnVsZS50eXBlID09PSAnbWVkaWEnKSB7XG4gICAgICBydWxlLnJ1bGVzLmZvckVhY2goKGl0ZW06IFJ1bGUpID0+IHtcbiAgICAgICAgZGV0ZWN0TWlzc2luZ0NsYXNzZXMoaXRlbSwgaW52YWxpZFJ1bGVzLCBpbnZhbGlkQ2xhc3NOYW1lcywgc2VsZWN0b3JzLCBiZW1TZWxlY3RvcnMpO1xuICAgICAgfSk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4geyBydWxlczogWy4uLm5ldyBTZXQoaW52YWxpZFJ1bGVzKV0sIGlzQmVtRGV0ZWN0ZWQ6IGJlbVNlbGVjdG9ycy5sZW5ndGggPiAwIH07XG59O1xuXG5jb25zdCBpc0NsYXNzTmFtZUV4aXN0SW5Db2xsZWN0aW9uID0gKFxuICBpbnZhbGlkQ2xhc3NOYW1lczogQ2xhc3NOYW1lc1R5cGUsXG4gIHNlbGVjdG9yczogU2VsZWN0b3JzVHlwZSxcbiAgY2xhc3NOYW1lOiBDbGFzc05hbWVUeXBlLFxuKTogYm9vbGVhbiA9PiBzZWxlY3RvcnMuaW5jbHVkZXMoY2xhc3NOYW1lKTtcblxuY29uc3QgZGV0ZWN0TWlzc2luZ0NsYXNzZXMgPSAoXG4gIHJ1bGU6IFJ1bGUsXG4gIGludmFsaWRSdWxlczogb2JqZWN0W10sXG4gIGludmFsaWRDbGFzc05hbWVzOiBDbGFzc05hbWVzVHlwZSxcbiAgc2VsZWN0b3JzOiBTZWxlY3RvcnNUeXBlLFxuICBiZW1TZWxlY3RvcnM6IFNlbGVjdG9yc1R5cGUsXG4pID0+IHtcbiAgaWYgKHJ1bGUudHlwZSA9PT0gJ3J1bGUnKSB7XG4gICAgY29uc3Qgc2VsZWN0b3IgPSBydWxlLnNlbGVjdG9yc1swXTtcblxuICAgIGNvbnN0IGFsbFNlbGVjdG9yczogc3RyaW5nW10gPSBbXG4gICAgICAuLi5uZXcgU2V0KFxuICAgICAgICBbXVxuICAgICAgICAgIC5jb25jYXQoLi4uc2VsZWN0b3Iuc3BsaXQoJy4nKSlcbiAgICAgICAgICAuZmlsdGVyKChjbGFzc05hbWUpID0+IGNsYXNzTmFtZSlcbiAgICAgICAgICAubWFwKChjbGFzc05hbWUpID0+IGAuJHtjbGFzc05hbWV9YCksXG4gICAgICApLFxuICAgIF07XG4gICAgc2VsZWN0b3JzLnB1c2goLi4uYWxsU2VsZWN0b3JzKTtcblxuICAgIHJ1bGUuZGVjbGFyYXRpb25zLmZvckVhY2goKGRlY2xhcmF0aW9uOiBJWFNob3VsZERlY2xhcmF0aW9uKSA9PiB7XG4gICAgICBpZiAoZGVjbGFyYXRpb24ucHJvcGVydHkgPT09ICd4LXNob3VsZCcpIHtcbiAgICAgICAgYmVtU2VsZWN0b3JzLnB1c2goc2VsZWN0b3IpO1xuICAgICAgICBjb25zdCBydWxlRGVjbGFyYXRpb246IFJlZ0V4cE1hdGNoQXJyYXkgPSBkZWNsYXJhdGlvbi52YWx1ZS5tYXRjaCgvKD89XFwuKSguKikoPz0nKS9nKTtcbiAgICAgICAgY29uc3QgY2xhc3NOYW1lc0RlY2xhcmF0aW9uOiBSZWdFeHBNYXRjaEFycmF5ID0gcnVsZURlY2xhcmF0aW9uWzBdLm1hdGNoKC8oXFwuXFxTKykvZyk7XG5cbiAgICAgICAgY29uc3QgY2xhc3NOYW1lID0gY2xhc3NOYW1lc0RlY2xhcmF0aW9uWzBdO1xuXG4gICAgICAgIGlmIChpc0NsYXNzTmFtZUV4aXN0SW5Db2xsZWN0aW9uKGludmFsaWRDbGFzc05hbWVzLCBzZWxlY3RvcnMsIGNsYXNzTmFtZSkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoQmVtUGFyc2VyLmlzQmVtTW9kaWZpZXIoc2VsZWN0b3IpICYmIEJlbVBhcnNlci5pc0JlbUJsb2NrKGNsYXNzTmFtZSkpIHtcbiAgICAgICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoY2xhc3NOYW1lLCAnZycpO1xuICAgICAgICAgIGNvbnN0IG1hdGNoZWQgPSBzZWxlY3Rvci5tYXRjaChyZWdleCk7XG5cbiAgICAgICAgICBpZiAobWF0Y2hlZC5sZW5ndGggPD0gMSkge1xuICAgICAgICAgICAgaW52YWxpZENsYXNzTmFtZXMucHVzaChjbGFzc05hbWUpO1xuICAgICAgICAgICAgaW52YWxpZFJ1bGVzLnB1c2goeyBjbGFzc05hbWUsIHJ1bGUgfSk7XG5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoQmVtUGFyc2VyLmlzQmVtQmxvY2soc2VsZWN0b3IpICYmICFCZW1QYXJzZXIuaXNCZW1Nb2RpZmllcihjbGFzc05hbWUpICYmICFCZW1QYXJzZXIuaXNCZW1CbG9jayhjbGFzc05hbWUpKSB7XG4gICAgICAgICAgaW52YWxpZENsYXNzTmFtZXMucHVzaChjbGFzc05hbWUpO1xuICAgICAgICAgIGludmFsaWRSdWxlcy5wdXNoKHsgY2xhc3NOYW1lLCBydWxlIH0pO1xuXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKEJlbVBhcnNlci5pc0JlbU1vZGlmaWVyKHNlbGVjdG9yKSkge1xuICAgICAgICAgIGludmFsaWRDbGFzc05hbWVzLnB1c2goY2xhc3NOYW1lKTtcbiAgICAgICAgICBpbnZhbGlkUnVsZXMucHVzaCh7IGNsYXNzTmFtZSwgcnVsZSB9KTtcblxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9XG59O1xuIiwiaW1wb3J0IHsgQXRSdWxlLCBDb21tZW50LCBSdWxlIH0gZnJvbSAnY3NzJztcbmltcG9ydCBCZW1QYXJzZXIgZnJvbSAnLi9CZW1QYXJzZXInO1xuaW1wb3J0IHsgSU1lZGlhUXVlcnkgfSBmcm9tICcuL0lNZWRpYVF1ZXJ5JztcbmltcG9ydCB7IFNlbGVjdG9yVHlwZSB9IGZyb20gJy4vbGludCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVhTaG91bGREZWNsYXJhdGlvbiB7XG4gIHR5cGU6IHN0cmluZztcbiAgcHJvcGVydHk6IHN0cmluZztcbiAgdmFsdWU6IHN0cmluZztcbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUnVsZXNSZXNvbHZlciB7XG4gIHByaXZhdGUgc3RhdGljIGlzTm90TWVkaWFRdWVyeShydWxlOiBJTWVkaWFRdWVyeSB8IFJ1bGUpOiBib29sZWFuIHtcbiAgICByZXR1cm4gcnVsZS50eXBlICE9PSAnbWVkaWEnO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgaXNSdWxlKHJ1bGU6IElNZWRpYVF1ZXJ5IHwgUnVsZSk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBydWxlLnR5cGUgPT09ICdydWxlJztcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGlzQ3NzQ2xhc3Moc2VsZWN0b3I6IFNlbGVjdG9yVHlwZSk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IHBhdHRlcm46IFJlZ0V4cCA9IC8oXFwuXFxTKykvZztcblxuICAgIHJldHVybiAhIXNlbGVjdG9yLm1hdGNoKHBhdHRlcm4pO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgcmVtb3ZlSW52YWxpZE1hdGNoZXMobWF0Y2hlczogc3RyaW5nW10pOiBzdHJpbmdbXSB7XG4gICAgcmV0dXJuIG1hdGNoZXMuZmlsdGVyKChtYXRjaCkgPT4gIW1hdGNoLm1hdGNoKC9cXFsuKy9nKSk7XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBnZXRMYXN0UGFydE9mQ3NzQ2xhc3Moc2VsZWN0b3I6IFNlbGVjdG9yVHlwZSk6IHN0cmluZyB7XG4gICAgY29uc3QgcGFydHM6IHN0cmluZ1tdID0gc2VsZWN0b3Iuc3BsaXQoJy4nKS5maWx0ZXIoQm9vbGVhbik7XG5cbiAgICByZXR1cm4gJy4nICsgcGFydHMucG9wKCk7XG4gIH1cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBydWxlczogQXJyYXk8UnVsZSB8IENvbW1lbnQgfCBBdFJ1bGU+KSB7fVxuXG4gIHB1YmxpYyByZXNvbHZlKCk6IEFycmF5PFJ1bGUgfCBJTWVkaWFRdWVyeT4ge1xuICAgIGNvbnN0IHJlc3VsdDogQXJyYXk8UnVsZSB8IElNZWRpYVF1ZXJ5PiA9IFtdO1xuXG4gICAgdGhpcy5ydWxlcy5mb3JFYWNoKFxuICAgICAgKHJ1bGU6IGFueSk6IHZvaWQgPT4ge1xuICAgICAgICBpZiAoUnVsZXNSZXNvbHZlci5pc05vdE1lZGlhUXVlcnkocnVsZSkgJiYgUnVsZXNSZXNvbHZlci5pc1J1bGUocnVsZSkpIHtcbiAgICAgICAgICBjb25zdCBydWxlcyA9IHRoaXMuZmxhdHRlblJ1bGVzKFtydWxlXSk7XG5cbiAgICAgICAgICBydWxlcy5tYXAoKGl0ZW06IGFueSkgPT4gcmVzdWx0LnB1c2godGhpcy5nZXRSdWxlV2l0aEJlbURlY2xhcmF0aW9ucyhpdGVtKSkpO1xuXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgcnVsZS5ydWxlcyA9IHRoaXMuZmxhdHRlblJ1bGVzKHJ1bGUucnVsZXMpO1xuXG4gICAgICAgIHJ1bGUucnVsZXMgPSBydWxlLnJ1bGVzLm1hcCgoaXRlbTogYW55KSA9PiB0aGlzLmdldFJ1bGVXaXRoQmVtRGVjbGFyYXRpb25zKGl0ZW0pKTtcblxuICAgICAgICByZXN1bHQucHVzaChydWxlKTtcbiAgICAgIH0sXG4gICAgKTtcblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBwcml2YXRlIGZsYXR0ZW5SdWxlcyhydWxlczogUnVsZVtdKTogUnVsZVtdIHtcbiAgICBjb25zdCByZXN1bHRzOiBSdWxlW10gPSBbXTtcblxuICAgIGlmICghcnVsZXMpIHtcbiAgICAgIHJldHVybiByZXN1bHRzO1xuICAgIH1cblxuICAgIHJ1bGVzLmZvckVhY2goXG4gICAgICAocnVsZSk6IHZvaWQgPT4ge1xuICAgICAgICBpZiAoIXJ1bGUuc2VsZWN0b3JzKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgcnVsZS5zZWxlY3RvcnMuZm9yRWFjaChcbiAgICAgICAgICAoc2VsZWN0b3IpOiB2b2lkID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG5ld1J1bGU6IFJ1bGUgPSB7XG4gICAgICAgICAgICAgIGRlY2xhcmF0aW9uczogcnVsZS5kZWNsYXJhdGlvbnMsXG4gICAgICAgICAgICAgIHBvc2l0aW9uOiBydWxlLnBvc2l0aW9uLFxuICAgICAgICAgICAgICBzZWxlY3RvcnM6IFtzZWxlY3Rvcl0sXG4gICAgICAgICAgICAgIHR5cGU6IHJ1bGUudHlwZSxcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHJlc3VsdHMucHVzaChuZXdSdWxlKTtcbiAgICAgICAgICB9LFxuICAgICAgICApO1xuICAgICAgfSxcbiAgICApO1xuXG4gICAgcmV0dXJuIHJlc3VsdHM7XG4gIH1cblxuICBwcml2YXRlIGdldFJ1bGVXaXRoQmVtRGVjbGFyYXRpb25zKHJ1bGU6IFJ1bGUpOiBSdWxlIHtcbiAgICBjb25zdCBzZWxlY3RvcnNXaXRoQ3NzQ2xhc3M6IHN0cmluZ1tdID0gW107XG5cbiAgICBydWxlLnNlbGVjdG9ycy5mb3JFYWNoKFxuICAgICAgKHNlbGVjdG9yKTogdm9pZCA9PiB7XG4gICAgICAgIGlmIChSdWxlc1Jlc29sdmVyLmlzQ3NzQ2xhc3Moc2VsZWN0b3IpKSB7XG4gICAgICAgICAgc2VsZWN0b3IgPSBSdWxlc1Jlc29sdmVyLmdldExhc3RQYXJ0T2ZDc3NDbGFzcyhzZWxlY3Rvcik7XG4gICAgICAgICAgc2VsZWN0b3JzV2l0aENzc0NsYXNzLnB1c2goc2VsZWN0b3IpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICk7XG5cbiAgICBpZiAoc2VsZWN0b3JzV2l0aENzc0NsYXNzLmxlbmd0aCA8IDEpIHtcbiAgICAgIHJldHVybiBydWxlO1xuICAgIH1cblxuICAgIGxldCBwYXJhbXM6IHN0cmluZ1tdID0gQmVtUGFyc2VyLnBhcnNlKHNlbGVjdG9yc1dpdGhDc3NDbGFzc1swXSk7XG5cbiAgICBwYXJhbXMgPSBSdWxlc1Jlc29sdmVyLnJlbW92ZUludmFsaWRNYXRjaGVzKHBhcmFtcyk7XG5cbiAgICBpZiAoIXBhcmFtcykge1xuICAgICAgcmV0dXJuIHJ1bGU7XG4gICAgfVxuXG4gICAgcnVsZS5kZWNsYXJhdGlvbnMgPSBydWxlLmRlY2xhcmF0aW9ucy5jb25jYXQoXG4gICAgICBwYXJhbXMubWFwKFxuICAgICAgICAocGFyYW0pOiBJWFNob3VsZERlY2xhcmF0aW9uID0+ICh7IHR5cGU6ICdkZWNsYXJhdGlvbicsIHByb3BlcnR5OiAneC1zaG91bGQnLCB2YWx1ZTogYG1hdGNoICcke3BhcmFtfSdgIH0pLFxuICAgICAgKSxcbiAgICApO1xuXG4gICAgcmV0dXJuIHJ1bGU7XG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=