!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var s in r)("object"==typeof exports?exports:e)[s]=r[s]}}(window,function(){return function(e){var t={};function r(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(s,o,function(t){return e[t]}.bind(null,o));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class s{static parse(e){let t=[];return t=s.getParts(e,t,s.isBemBlock(e),s.getBlockParam),t=s.getParts(e,t,s.isBemModifier(e),s.getModifierParam)}static isBemBlock(e){return!!e.match(s.BLOCK_PATTERN)}static isBemModifier(e){return!!e.match(s.MODIFIER_PATTERN)}static getParts(e,t,r,s){if(!r)return t;return e.split(".").filter(Boolean).forEach(e=>{(e=s(e))&&!t.includes(e)&&t.push(e)}),t}static getBlockParam(e){const t=/\S+?(?=__)/g;return e.match(t)&&"."+e.match(t)[0]+" *"}static getModifierParam(e){const t=/\S+?(?=--)/g;return e.match(t)&&"."+e.match(t)[0]}}s.BLOCK_PATTERN=/\S+__\S+/g,s.MODIFIER_PATTERN=/\S+--\S+/g,t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(2),o=r(3),i=e=>new o.default(e.stylesheet.rules).resolve();t.preprocess=((e,t)=>(e.stylesheet.rules=i(e),t())),t.processLint=(e=>(e.stylesheet.rules=i(e),s.lint(e))),t.name="BEM"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(0);t.lint=(e=>{const{rules:t,isBemDetected:r}=o(e);return{isBemDetected:r,isValid:r&&0===t.length,rules:t.map(({rule:e,className:t})=>({missingClassName:t,selector:e.selectors[0]||""}))}});const o=e=>{const t=[],r=[],s=[],o=[];return e.stylesheet.rules.forEach(e=>{i(e,t,r,s,o),"media"===e.type&&e.rules.forEach(e=>{i(e,t,r,s,o)})}),{rules:[...new Set(t)],isBemDetected:o.length>0}},i=(e,t,r,o,i)=>{if("rule"===e.type){const n=e.selectors[0],l=[...new Set([].concat(...n.split(".")).filter(e=>e).map(e=>`.${e}`))];o.push(...l),e.declarations.forEach(l=>{if("x-should"===l.property){i.push(n);const a=l.value.match(/(?=\.)(.*)(?=')/g)[0].match(/(\.\S+)/g)[0];if(((e,t,r)=>t.includes(r))(0,o,a))return;if(s.default.isBemModifier(n)&&s.default.isBemBlock(a)){const s=new RegExp(a,"g");if(n.match(s).length<=1)return r.push(a),void t.push({className:a,rule:e})}if(s.default.isBemBlock(n)&&!s.default.isBemModifier(a)&&!s.default.isBemBlock(a))return r.push(a),void t.push({className:a,rule:e});if(s.default.isBemModifier(n))return r.push(a),void t.push({className:a,rule:e})}})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(0);class o{constructor(e){this.rules=e}static isNotMediaQuery(e){return"media"!==e.type}static isRule(e){return"rule"===e.type}static isCssClass(e){return!!e.match(/(\.\S+)/g)}static removeInvalidMatches(e){return e.filter(e=>!e.match(/\[.+/g))}static getLastPartOfCssClass(e){return"."+e.split(".").filter(Boolean).pop()}resolve(){const e=[];return this.rules.forEach(t=>{if(o.isNotMediaQuery(t)&&o.isRule(t)){this.flattenRules([t]).map(t=>e.push(this.getRuleWithBemDeclarations(t)))}else t.rules=this.flattenRules(t.rules),t.rules=t.rules.map(e=>this.getRuleWithBemDeclarations(e)),e.push(t)}),e}flattenRules(e){const t=[];return e?(e.forEach(e=>{e.selectors&&e.selectors.forEach(r=>{const s={declarations:e.declarations,position:e.position,selectors:[r],type:e.type};t.push(s)})}),t):t}getRuleWithBemDeclarations(e){const t=[];if(e.selectors.forEach(e=>{o.isCssClass(e)&&(e=o.getLastPartOfCssClass(e),t.push(e))}),t.length<1)return e;let r=s.default.parse(t[0]);return(r=o.removeInvalidMatches(r))?(e.declarations=e.declarations.concat(r.map(e=>({type:"declaration",property:"x-should",value:`match '${e}'`}))),e):e}}t.default=o}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly8vLi9zcmMvQmVtUGFyc2VyLnRzIiwid2VicGFjazovLy8uL3NyYy9pbmRleC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbGludC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvUnVsZXNSZXNvbHZlci50cyJdLCJuYW1lcyI6WyJyb290IiwiZmFjdG9yeSIsImV4cG9ydHMiLCJtb2R1bGUiLCJkZWZpbmUiLCJhbWQiLCJhIiwiaSIsIndpbmRvdyIsImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIkJlbVBhcnNlciIsIltvYmplY3QgT2JqZWN0XSIsImNsYXNzTmFtZSIsInBhcnRzIiwiZ2V0UGFydHMiLCJpc0JlbUJsb2NrIiwiZ2V0QmxvY2tQYXJhbSIsImlzQmVtTW9kaWZpZXIiLCJnZXRNb2RpZmllclBhcmFtIiwibWF0Y2giLCJCTE9DS19QQVRURVJOIiwiTU9ESUZJRVJfUEFUVEVSTiIsInNob3VsZEJlUGFydE9mIiwiYmVtVHlwZSIsImdldFBhcmFtIiwic3BsaXQiLCJmaWx0ZXIiLCJCb29sZWFuIiwiZm9yRWFjaCIsInBhcnQiLCJpbmNsdWRlcyIsInB1c2giLCJibG9ja1BhdHRlcm4iLCJtb2RpZmllclBhdHRlcm4iLCJkZWZhdWx0IiwibGludF8xIiwiUnVsZXNSZXNvbHZlcl8xIiwicHJvY2VzcyIsImN0eCIsInN0eWxlc2hlZXQiLCJydWxlcyIsInJlc29sdmUiLCJwcmVwcm9jZXNzIiwibmV4dCIsInByb2Nlc3NMaW50IiwibGludCIsIkJlbVBhcnNlcl8xIiwiY3NzIiwiaXNCZW1EZXRlY3RlZCIsImdldEludmFsaWRSdWxlcyIsImlzVmFsaWQiLCJsZW5ndGgiLCJtYXAiLCJydWxlIiwibWlzc2luZ0NsYXNzTmFtZSIsInNlbGVjdG9yIiwic2VsZWN0b3JzIiwiaW52YWxpZFJ1bGVzIiwiaW52YWxpZENsYXNzTmFtZXMiLCJiZW1TZWxlY3RvcnMiLCJkZXRlY3RJbnZhbGlkUnVsZXMiLCJ0eXBlIiwiaXRlbSIsIlNldCIsImFsbFNlbGVjdG9ycyIsImNvbmNhdCIsImRlY2xhcmF0aW9ucyIsImRlY2xhcmF0aW9uIiwiaXNDbGFzc05hbWVFeGlzdEluQ29sbGVjdGlvbiIsInJlZ2V4IiwiUmVnRXhwIiwiUnVsZXNSZXNvbHZlciIsInRoaXMiLCJtYXRjaGVzIiwicG9wIiwicmVzdWx0IiwiaXNOb3RNZWRpYVF1ZXJ5IiwiaXNSdWxlIiwiZmxhdHRlblJ1bGVzIiwiZ2V0UnVsZVdpdGhCZW1EZWNsYXJhdGlvbnMiLCJyZXN1bHRzIiwibmV3UnVsZSIsInBvc2l0aW9uIiwic2VsZWN0b3JzV2l0aENzc0NsYXNzIiwiaXNDc3NDbGFzcyIsImdldExhc3RQYXJ0T2ZDc3NDbGFzcyIsInBhcmFtcyIsInBhcnNlIiwicmVtb3ZlSW52YWxpZE1hdGNoZXMiLCJwYXJhbSJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBQUEsRUFBQUMsR0FDQSxvQkFBQUMsU0FBQSxpQkFBQUMsT0FDQUEsT0FBQUQsUUFBQUQsU0FDQSxzQkFBQUcsZUFBQUMsSUFDQUQsT0FBQSxHQUFBSCxPQUNBLENBQ0EsSUFBQUssRUFBQUwsSUFDQSxRQUFBTSxLQUFBRCxHQUFBLGlCQUFBSixnQkFBQUYsR0FBQU8sR0FBQUQsRUFBQUMsSUFQQSxDQVNDQyxP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SUFBSWlDLEVBQW1CeEMsRUFBQVosUUFBVXFELE1BQU1KLEVBQXNCLElBSTdELE9BRkFHLEVBQVNmLEVBQWNpQixxQkFBcUJGLEtBTTVDakMsRUFBS2EsYUFBZWIsRUFBS2EsYUFBYUQsT0FDcENxQixFQUFPbEMsSUFDSnFDLElBQStCLENBQUc1QixLQUFNLGNBQWV4RCxTQUFVLFdBQVlWLGdCQUFpQjhGLFNBSTVGcEMsR0FURUEsR0F0R2JwRixFQUFBaUUsUUFBQXFDIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoW10sIGZhY3RvcnkpO1xuXHRlbHNlIHtcblx0XHR2YXIgYSA9IGZhY3RvcnkoKTtcblx0XHRmb3IodmFyIGkgaW4gYSkgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyA/IGV4cG9ydHMgOiByb290KVtpXSA9IGFbaV07XG5cdH1cbn0pKHdpbmRvdywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDEpO1xuIiwiaW1wb3J0IHsgQ2xhc3NOYW1lVHlwZSB9IGZyb20gJy4vbGludCc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEJlbVBhcnNlciB7XG4gIHB1YmxpYyBzdGF0aWMgcGFyc2UoY2xhc3NOYW1lOiBDbGFzc05hbWVUeXBlKTogc3RyaW5nW10ge1xuICAgIGxldCBwYXJ0czogc3RyaW5nW10gPSBbXTtcblxuICAgIHBhcnRzID0gQmVtUGFyc2VyLmdldFBhcnRzKGNsYXNzTmFtZSwgcGFydHMsIEJlbVBhcnNlci5pc0JlbUJsb2NrKGNsYXNzTmFtZSksIEJlbVBhcnNlci5nZXRCbG9ja1BhcmFtKTtcbiAgICBwYXJ0cyA9IEJlbVBhcnNlci5nZXRQYXJ0cyhjbGFzc05hbWUsIHBhcnRzLCBCZW1QYXJzZXIuaXNCZW1Nb2RpZmllcihjbGFzc05hbWUpLCBCZW1QYXJzZXIuZ2V0TW9kaWZpZXJQYXJhbSk7XG5cbiAgICByZXR1cm4gcGFydHM7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGlzQmVtQmxvY2soY2xhc3NOYW1lOiBDbGFzc05hbWVUeXBlKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICEhY2xhc3NOYW1lLm1hdGNoKEJlbVBhcnNlci5CTE9DS19QQVRURVJOKTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgaXNCZW1Nb2RpZmllcihjbGFzc05hbWU6IENsYXNzTmFtZVR5cGUpOiBib29sZWFuIHtcbiAgICByZXR1cm4gISFjbGFzc05hbWUubWF0Y2goQmVtUGFyc2VyLk1PRElGSUVSX1BBVFRFUk4pO1xuICB9XG4gIHByaXZhdGUgc3RhdGljIEJMT0NLX1BBVFRFUk46IFJlZ0V4cCA9IC9cXFMrX19cXFMrL2c7XG4gIHByaXZhdGUgc3RhdGljIE1PRElGSUVSX1BBVFRFUk46IFJlZ0V4cCA9IC9cXFMrLS1cXFMrL2c7XG5cbiAgcHJpdmF0ZSBzdGF0aWMgZ2V0UGFydHMoXG4gICAgY2xhc3NOYW1lOiBDbGFzc05hbWVUeXBlLFxuICAgIHNob3VsZEJlUGFydE9mOiBzdHJpbmdbXSxcbiAgICBiZW1UeXBlOiBib29sZWFuLFxuICAgIGdldFBhcmFtOiAoY2xhc3NOYW1lOiBDbGFzc05hbWVUeXBlKSA9PiBzdHJpbmcsXG4gICk6IHN0cmluZ1tdIHtcbiAgICBpZiAoIWJlbVR5cGUpIHtcbiAgICAgIHJldHVybiBzaG91bGRCZVBhcnRPZjtcbiAgICB9XG5cbiAgICBjb25zdCBwYXJ0czogc3RyaW5nW10gPSBjbGFzc05hbWUuc3BsaXQoJy4nKS5maWx0ZXIoQm9vbGVhbik7XG5cbiAgICBwYXJ0cy5mb3JFYWNoKChwYXJ0KSA9PiB7XG4gICAgICBwYXJ0ID0gZ2V0UGFyYW0ocGFydCk7XG5cbiAgICAgIGlmIChwYXJ0ICYmICFzaG91bGRCZVBhcnRPZi5pbmNsdWRlcyhwYXJ0KSkge1xuICAgICAgICBzaG91bGRCZVBhcnRPZi5wdXNoKHBhcnQpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHNob3VsZEJlUGFydE9mO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgZ2V0QmxvY2tQYXJhbShjbGFzc05hbWU6IENsYXNzTmFtZVR5cGUpOiBzdHJpbmcge1xuICAgIGNvbnN0IGJsb2NrUGF0dGVybjogUmVnRXhwID0gL1xcUys/KD89X18pL2c7XG5cbiAgICByZXR1cm4gY2xhc3NOYW1lLm1hdGNoKGJsb2NrUGF0dGVybikgJiYgJy4nICsgY2xhc3NOYW1lLm1hdGNoKGJsb2NrUGF0dGVybilbMF0gKyAnIConO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgZ2V0TW9kaWZpZXJQYXJhbShjbGFzc05hbWU6IENsYXNzTmFtZVR5cGUpOiBzdHJpbmcge1xuICAgIGNvbnN0IG1vZGlmaWVyUGF0dGVybjogUmVnRXhwID0gL1xcUys/KD89LS0pL2c7XG5cbiAgICByZXR1cm4gY2xhc3NOYW1lLm1hdGNoKG1vZGlmaWVyUGF0dGVybikgJiYgJy4nICsgY2xhc3NOYW1lLm1hdGNoKG1vZGlmaWVyUGF0dGVybilbMF07XG4gIH1cbn1cbiIsImltcG9ydCB7IFJ1bGUsIFN0eWxlc2hlZXQgfSBmcm9tICdjc3MnO1xuaW1wb3J0IHsgSU1lZGlhUXVlcnkgfSBmcm9tICcuL0lNZWRpYVF1ZXJ5JztcbmltcG9ydCB7IElMaW50UnVsZSwgbGludCB9IGZyb20gJy4vbGludCc7XG5pbXBvcnQgUnVsZXNSZXNvbHZlciBmcm9tICcuL1J1bGVzUmVzb2x2ZXInO1xuXG5jb25zdCBwcm9jZXNzID0gKGN0eDogU3R5bGVzaGVldCk6IEFycmF5PFJ1bGUgfCBJTWVkaWFRdWVyeT4gPT4gbmV3IFJ1bGVzUmVzb2x2ZXIoY3R4LnN0eWxlc2hlZXQucnVsZXMpLnJlc29sdmUoKTtcblxuZXhwb3J0IGNvbnN0IHByZXByb2Nlc3MgPSAoY3R4OiBTdHlsZXNoZWV0LCBuZXh0OiAoKSA9PiBhbnkpOiBhbnkgPT4ge1xuICBjdHguc3R5bGVzaGVldC5ydWxlcyA9IHByb2Nlc3MoY3R4KTtcblxuICByZXR1cm4gbmV4dCgpO1xufTtcblxuZXhwb3J0IGNvbnN0IHByb2Nlc3NMaW50ID0gKGN0eDogU3R5bGVzaGVldCk6IHsgcnVsZXM6IElMaW50UnVsZVtdOyBpc1ZhbGlkOiBib29sZWFuOyBpc0JlbURldGVjdGVkOiBib29sZWFuIH0gPT4ge1xuICBjdHguc3R5bGVzaGVldC5ydWxlcyA9IHByb2Nlc3MoY3R4KTtcblxuICByZXR1cm4gbGludChjdHgpO1xufTtcblxuZXhwb3J0IGNvbnN0IG5hbWU6IHN0cmluZyA9ICdCRU0nO1xuIiwiaW1wb3J0IHsgTWVkaWEsIFJ1bGUsIFN0eWxlc2hlZXQgfSBmcm9tICdjc3MnO1xuaW1wb3J0IEJlbVBhcnNlciBmcm9tICcuL0JlbVBhcnNlcic7XG5pbXBvcnQgeyBJWFNob3VsZERlY2xhcmF0aW9uIH0gZnJvbSAnLi9SdWxlc1Jlc29sdmVyJztcblxuZXhwb3J0IHR5cGUgQ2xhc3NOYW1lVHlwZSA9IHN0cmluZztcbnR5cGUgQ2xhc3NOYW1lc1R5cGUgPSBDbGFzc05hbWVUeXBlW107XG5leHBvcnQgdHlwZSBTZWxlY3RvclR5cGUgPSBzdHJpbmc7XG50eXBlIFNlbGVjdG9yc1R5cGUgPSBTZWxlY3RvclR5cGVbXTtcbmV4cG9ydCBpbnRlcmZhY2UgSUxpbnRSdWxlIHtcbiAgbWlzc2luZ0NsYXNzTmFtZTogQ2xhc3NOYW1lVHlwZTtcbiAgc2VsZWN0b3I6IFNlbGVjdG9yVHlwZTtcbn1cblxuZXhwb3J0IGNvbnN0IGxpbnQgPSAoY3NzOiBTdHlsZXNoZWV0KTogeyBydWxlczogSUxpbnRSdWxlW107IGlzVmFsaWQ6IGJvb2xlYW47IGlzQmVtRGV0ZWN0ZWQ6IGJvb2xlYW4gfSA9PiB7XG4gIGNvbnN0IHsgcnVsZXMsIGlzQmVtRGV0ZWN0ZWQgfSA9IGdldEludmFsaWRSdWxlcyhjc3MpO1xuXG4gIHJldHVybiB7XG4gICAgaXNCZW1EZXRlY3RlZCxcbiAgICBpc1ZhbGlkOiBpc0JlbURldGVjdGVkICYmIHJ1bGVzLmxlbmd0aCA9PT0gMCxcbiAgICBydWxlczogcnVsZXMubWFwKCh7IHJ1bGUsIGNsYXNzTmFtZSB9KSA9PiAoe1xuICAgICAgbWlzc2luZ0NsYXNzTmFtZTogY2xhc3NOYW1lLFxuICAgICAgc2VsZWN0b3I6IHJ1bGUuc2VsZWN0b3JzWzBdIHx8ICcnLFxuICAgIH0pKSxcbiAgfTtcbn07XG5cbmNvbnN0IGdldEludmFsaWRSdWxlcyA9IChcbiAgY3NzOiBTdHlsZXNoZWV0LFxuKTogeyBydWxlczogQXJyYXk8eyBjbGFzc05hbWU6IENsYXNzTmFtZVR5cGU7IHJ1bGU6IFJ1bGUgfT47IGlzQmVtRGV0ZWN0ZWQ6IGJvb2xlYW4gfSA9PiB7XG4gIGNvbnN0IGludmFsaWRSdWxlcyA9IFtdO1xuICBjb25zdCBpbnZhbGlkQ2xhc3NOYW1lcyA9IFtdO1xuICBjb25zdCBzZWxlY3RvcnMgPSBbXTtcbiAgY29uc3QgYmVtU2VsZWN0b3JzID0gW107XG5cbiAgY3NzLnN0eWxlc2hlZXQucnVsZXMuZm9yRWFjaCgocnVsZTogUnVsZSAmIE1lZGlhKSA9PiB7XG4gICAgZGV0ZWN0SW52YWxpZFJ1bGVzKHJ1bGUsIGludmFsaWRSdWxlcywgaW52YWxpZENsYXNzTmFtZXMsIHNlbGVjdG9ycywgYmVtU2VsZWN0b3JzKTtcblxuICAgIGlmIChydWxlLnR5cGUgPT09ICdtZWRpYScpIHtcbiAgICAgIHJ1bGUucnVsZXMuZm9yRWFjaCgoaXRlbTogUnVsZSkgPT4ge1xuICAgICAgICBkZXRlY3RJbnZhbGlkUnVsZXMoaXRlbSwgaW52YWxpZFJ1bGVzLCBpbnZhbGlkQ2xhc3NOYW1lcywgc2VsZWN0b3JzLCBiZW1TZWxlY3RvcnMpO1xuICAgICAgfSk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4geyBydWxlczogWy4uLm5ldyBTZXQoaW52YWxpZFJ1bGVzKV0sIGlzQmVtRGV0ZWN0ZWQ6IGJlbVNlbGVjdG9ycy5sZW5ndGggPiAwIH07XG59O1xuXG5jb25zdCBpc0NsYXNzTmFtZUV4aXN0SW5Db2xsZWN0aW9uID0gKFxuICBpbnZhbGlkQ2xhc3NOYW1lczogQ2xhc3NOYW1lc1R5cGUsXG4gIHNlbGVjdG9yczogU2VsZWN0b3JzVHlwZSxcbiAgY2xhc3NOYW1lOiBDbGFzc05hbWVUeXBlLFxuKTogYm9vbGVhbiA9PiBzZWxlY3RvcnMuaW5jbHVkZXMoY2xhc3NOYW1lKTtcblxuY29uc3QgZGV0ZWN0SW52YWxpZFJ1bGVzID0gKFxuICBydWxlOiBSdWxlLFxuICBpbnZhbGlkUnVsZXM6IG9iamVjdFtdLFxuICBpbnZhbGlkQ2xhc3NOYW1lczogQ2xhc3NOYW1lc1R5cGUsXG4gIHNlbGVjdG9yczogU2VsZWN0b3JzVHlwZSxcbiAgYmVtU2VsZWN0b3JzOiBTZWxlY3RvcnNUeXBlLFxuKTogdm9pZCA9PiB7XG4gIGlmIChydWxlLnR5cGUgPT09ICdydWxlJykge1xuICAgIGNvbnN0IHNlbGVjdG9yID0gcnVsZS5zZWxlY3RvcnNbMF07XG5cbiAgICBjb25zdCBhbGxTZWxlY3RvcnM6IHN0cmluZ1tdID0gW1xuICAgICAgLi4ubmV3IFNldChcbiAgICAgICAgW11cbiAgICAgICAgICAuY29uY2F0KC4uLnNlbGVjdG9yLnNwbGl0KCcuJykpXG4gICAgICAgICAgLmZpbHRlcigoY2xhc3NOYW1lKSA9PiBjbGFzc05hbWUpXG4gICAgICAgICAgLm1hcCgoY2xhc3NOYW1lKSA9PiBgLiR7Y2xhc3NOYW1lfWApLFxuICAgICAgKSxcbiAgICBdO1xuICAgIHNlbGVjdG9ycy5wdXNoKC4uLmFsbFNlbGVjdG9ycyk7XG5cbiAgICBydWxlLmRlY2xhcmF0aW9ucy5mb3JFYWNoKChkZWNsYXJhdGlvbjogSVhTaG91bGREZWNsYXJhdGlvbikgPT4ge1xuICAgICAgaWYgKGRlY2xhcmF0aW9uLnByb3BlcnR5ID09PSAneC1zaG91bGQnKSB7XG4gICAgICAgIGJlbVNlbGVjdG9ycy5wdXNoKHNlbGVjdG9yKTtcbiAgICAgICAgY29uc3QgcnVsZURlY2xhcmF0aW9uOiBSZWdFeHBNYXRjaEFycmF5ID0gZGVjbGFyYXRpb24udmFsdWUubWF0Y2goLyg/PVxcLikoLiopKD89JykvZyk7XG4gICAgICAgIGNvbnN0IGNsYXNzTmFtZXNEZWNsYXJhdGlvbjogUmVnRXhwTWF0Y2hBcnJheSA9IHJ1bGVEZWNsYXJhdGlvblswXS5tYXRjaCgvKFxcLlxcUyspL2cpO1xuXG4gICAgICAgIGNvbnN0IGNsYXNzTmFtZSA9IGNsYXNzTmFtZXNEZWNsYXJhdGlvblswXTtcblxuICAgICAgICBpZiAoaXNDbGFzc05hbWVFeGlzdEluQ29sbGVjdGlvbihpbnZhbGlkQ2xhc3NOYW1lcywgc2VsZWN0b3JzLCBjbGFzc05hbWUpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKEJlbVBhcnNlci5pc0JlbU1vZGlmaWVyKHNlbGVjdG9yKSAmJiBCZW1QYXJzZXIuaXNCZW1CbG9jayhjbGFzc05hbWUpKSB7XG4gICAgICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGNsYXNzTmFtZSwgJ2cnKTtcbiAgICAgICAgICBjb25zdCBtYXRjaGVkID0gc2VsZWN0b3IubWF0Y2gocmVnZXgpO1xuXG4gICAgICAgICAgaWYgKG1hdGNoZWQubGVuZ3RoIDw9IDEpIHtcbiAgICAgICAgICAgIGludmFsaWRDbGFzc05hbWVzLnB1c2goY2xhc3NOYW1lKTtcbiAgICAgICAgICAgIGludmFsaWRSdWxlcy5wdXNoKHsgY2xhc3NOYW1lLCBydWxlIH0pO1xuXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKEJlbVBhcnNlci5pc0JlbUJsb2NrKHNlbGVjdG9yKSAmJiAhQmVtUGFyc2VyLmlzQmVtTW9kaWZpZXIoY2xhc3NOYW1lKSAmJiAhQmVtUGFyc2VyLmlzQmVtQmxvY2soY2xhc3NOYW1lKSkge1xuICAgICAgICAgIGludmFsaWRDbGFzc05hbWVzLnB1c2goY2xhc3NOYW1lKTtcbiAgICAgICAgICBpbnZhbGlkUnVsZXMucHVzaCh7IGNsYXNzTmFtZSwgcnVsZSB9KTtcblxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChCZW1QYXJzZXIuaXNCZW1Nb2RpZmllcihzZWxlY3RvcikpIHtcbiAgICAgICAgICBpbnZhbGlkQ2xhc3NOYW1lcy5wdXNoKGNsYXNzTmFtZSk7XG4gICAgICAgICAgaW52YWxpZFJ1bGVzLnB1c2goeyBjbGFzc05hbWUsIHJ1bGUgfSk7XG5cbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufTtcbiIsImltcG9ydCB7IEF0UnVsZSwgQ29tbWVudCwgUnVsZSB9IGZyb20gJ2Nzcyc7XG5pbXBvcnQgQmVtUGFyc2VyIGZyb20gJy4vQmVtUGFyc2VyJztcbmltcG9ydCB7IElNZWRpYVF1ZXJ5IH0gZnJvbSAnLi9JTWVkaWFRdWVyeSc7XG5pbXBvcnQgeyBTZWxlY3RvclR5cGUgfSBmcm9tICcuL2xpbnQnO1xuXG5leHBvcnQgaW50ZXJmYWNlIElYU2hvdWxkRGVjbGFyYXRpb24ge1xuICB0eXBlOiBzdHJpbmc7XG4gIHByb3BlcnR5OiBzdHJpbmc7XG4gIHZhbHVlOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJ1bGVzUmVzb2x2ZXIge1xuICBwcml2YXRlIHN0YXRpYyBpc05vdE1lZGlhUXVlcnkocnVsZTogSU1lZGlhUXVlcnkgfCBSdWxlKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHJ1bGUudHlwZSAhPT0gJ21lZGlhJztcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGlzUnVsZShydWxlOiBJTWVkaWFRdWVyeSB8IFJ1bGUpOiBib29sZWFuIHtcbiAgICByZXR1cm4gcnVsZS50eXBlID09PSAncnVsZSc7XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBpc0Nzc0NsYXNzKHNlbGVjdG9yOiBTZWxlY3RvclR5cGUpOiBib29sZWFuIHtcbiAgICBjb25zdCBwYXR0ZXJuOiBSZWdFeHAgPSAvKFxcLlxcUyspL2c7XG5cbiAgICByZXR1cm4gISFzZWxlY3Rvci5tYXRjaChwYXR0ZXJuKTtcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIHJlbW92ZUludmFsaWRNYXRjaGVzKG1hdGNoZXM6IHN0cmluZ1tdKTogc3RyaW5nW10ge1xuICAgIHJldHVybiBtYXRjaGVzLmZpbHRlcigobWF0Y2gpID0+ICFtYXRjaC5tYXRjaCgvXFxbLisvZykpO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgZ2V0TGFzdFBhcnRPZkNzc0NsYXNzKHNlbGVjdG9yOiBTZWxlY3RvclR5cGUpOiBzdHJpbmcge1xuICAgIGNvbnN0IHBhcnRzOiBzdHJpbmdbXSA9IHNlbGVjdG9yLnNwbGl0KCcuJykuZmlsdGVyKEJvb2xlYW4pO1xuXG4gICAgcmV0dXJuICcuJyArIHBhcnRzLnBvcCgpO1xuICB9XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcnVsZXM6IEFycmF5PFJ1bGUgfCBDb21tZW50IHwgQXRSdWxlPikge31cblxuICBwdWJsaWMgcmVzb2x2ZSgpOiBBcnJheTxSdWxlIHwgSU1lZGlhUXVlcnk+IHtcbiAgICBjb25zdCByZXN1bHQ6IEFycmF5PFJ1bGUgfCBJTWVkaWFRdWVyeT4gPSBbXTtcblxuICAgIHRoaXMucnVsZXMuZm9yRWFjaChcbiAgICAgIChydWxlOiBhbnkpOiB2b2lkID0+IHtcbiAgICAgICAgaWYgKFJ1bGVzUmVzb2x2ZXIuaXNOb3RNZWRpYVF1ZXJ5KHJ1bGUpICYmIFJ1bGVzUmVzb2x2ZXIuaXNSdWxlKHJ1bGUpKSB7XG4gICAgICAgICAgY29uc3QgcnVsZXMgPSB0aGlzLmZsYXR0ZW5SdWxlcyhbcnVsZV0pO1xuXG4gICAgICAgICAgcnVsZXMubWFwKChpdGVtOiBhbnkpID0+IHJlc3VsdC5wdXNoKHRoaXMuZ2V0UnVsZVdpdGhCZW1EZWNsYXJhdGlvbnMoaXRlbSkpKTtcblxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJ1bGUucnVsZXMgPSB0aGlzLmZsYXR0ZW5SdWxlcyhydWxlLnJ1bGVzKTtcblxuICAgICAgICBydWxlLnJ1bGVzID0gcnVsZS5ydWxlcy5tYXAoKGl0ZW06IGFueSkgPT4gdGhpcy5nZXRSdWxlV2l0aEJlbURlY2xhcmF0aW9ucyhpdGVtKSk7XG5cbiAgICAgICAgcmVzdWx0LnB1c2gocnVsZSk7XG4gICAgICB9LFxuICAgICk7XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgcHJpdmF0ZSBmbGF0dGVuUnVsZXMocnVsZXM6IFJ1bGVbXSk6IFJ1bGVbXSB7XG4gICAgY29uc3QgcmVzdWx0czogUnVsZVtdID0gW107XG5cbiAgICBpZiAoIXJ1bGVzKSB7XG4gICAgICByZXR1cm4gcmVzdWx0cztcbiAgICB9XG5cbiAgICBydWxlcy5mb3JFYWNoKFxuICAgICAgKHJ1bGUpOiB2b2lkID0+IHtcbiAgICAgICAgaWYgKCFydWxlLnNlbGVjdG9ycykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJ1bGUuc2VsZWN0b3JzLmZvckVhY2goXG4gICAgICAgICAgKHNlbGVjdG9yKTogdm9pZCA9PiB7XG4gICAgICAgICAgICBjb25zdCBuZXdSdWxlOiBSdWxlID0ge1xuICAgICAgICAgICAgICBkZWNsYXJhdGlvbnM6IHJ1bGUuZGVjbGFyYXRpb25zLFxuICAgICAgICAgICAgICBwb3NpdGlvbjogcnVsZS5wb3NpdGlvbixcbiAgICAgICAgICAgICAgc2VsZWN0b3JzOiBbc2VsZWN0b3JdLFxuICAgICAgICAgICAgICB0eXBlOiBydWxlLnR5cGUsXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICByZXN1bHRzLnB1c2gobmV3UnVsZSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgKTtcbiAgICAgIH0sXG4gICAgKTtcblxuICAgIHJldHVybiByZXN1bHRzO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRSdWxlV2l0aEJlbURlY2xhcmF0aW9ucyhydWxlOiBSdWxlKTogUnVsZSB7XG4gICAgY29uc3Qgc2VsZWN0b3JzV2l0aENzc0NsYXNzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgcnVsZS5zZWxlY3RvcnMuZm9yRWFjaChcbiAgICAgIChzZWxlY3Rvcik6IHZvaWQgPT4ge1xuICAgICAgICBpZiAoUnVsZXNSZXNvbHZlci5pc0Nzc0NsYXNzKHNlbGVjdG9yKSkge1xuICAgICAgICAgIHNlbGVjdG9yID0gUnVsZXNSZXNvbHZlci5nZXRMYXN0UGFydE9mQ3NzQ2xhc3Moc2VsZWN0b3IpO1xuICAgICAgICAgIHNlbGVjdG9yc1dpdGhDc3NDbGFzcy5wdXNoKHNlbGVjdG9yKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICApO1xuXG4gICAgaWYgKHNlbGVjdG9yc1dpdGhDc3NDbGFzcy5sZW5ndGggPCAxKSB7XG4gICAgICByZXR1cm4gcnVsZTtcbiAgICB9XG5cbiAgICBsZXQgcGFyYW1zOiBzdHJpbmdbXSA9IEJlbVBhcnNlci5wYXJzZShzZWxlY3RvcnNXaXRoQ3NzQ2xhc3NbMF0pO1xuXG4gICAgcGFyYW1zID0gUnVsZXNSZXNvbHZlci5yZW1vdmVJbnZhbGlkTWF0Y2hlcyhwYXJhbXMpO1xuXG4gICAgaWYgKCFwYXJhbXMpIHtcbiAgICAgIHJldHVybiBydWxlO1xuICAgIH1cblxuICAgIHJ1bGUuZGVjbGFyYXRpb25zID0gcnVsZS5kZWNsYXJhdGlvbnMuY29uY2F0KFxuICAgICAgcGFyYW1zLm1hcChcbiAgICAgICAgKHBhcmFtKTogSVhTaG91bGREZWNsYXJhdGlvbiA9PiAoeyB0eXBlOiAnZGVjbGFyYXRpb24nLCBwcm9wZXJ0eTogJ3gtc2hvdWxkJywgdmFsdWU6IGBtYXRjaCAnJHtwYXJhbX0nYCB9KSxcbiAgICAgICksXG4gICAgKTtcblxuICAgIHJldHVybiBydWxlO1xuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9