!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var s in r)("object"==typeof exports?exports:e)[s]=r[s]}}(window,function(){return function(e){var t={};function r(s){if(t[s])return t[s].exports;var l=t[s]={i:s,l:!1,exports:{}};return e[s].call(l.exports,l,l.exports,r),l.l=!0,l.exports}return r.m=e,r.c=t,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)r.d(s,l,function(t){return e[t]}.bind(null,l));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class s{static parse(e){let t=[];return t=s.getParts(e,t,s.isBemBlock(e),s.getBlockParam),t=s.getParts(e,t,s.isBemModifier(e),s.getModifierParam)}static isBemBlock(e){return!!e.match(s.BLOCK_PATTERN)}static isBemModifier(e){return!!e.match(s.MODIFIER_PATTERN)}static getParts(e,t,r,s){if(!r)return t;return e.split(".").filter(Boolean).forEach(e=>{(e=s(e))&&!t.includes(e)&&t.push(e)}),t}static getBlockParam(e){const t=/\S+?(?=__)/g;return e.match(t)&&"."+e.match(t)[0]+" *"}static getModifierParam(e){const t=/\S+?(?=--)/g;return e.match(t)&&"."+e.match(t)[0]}}s.BLOCK_PATTERN=/\S+__\S+/g,s.MODIFIER_PATTERN=/\S+--\S+/g,t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(2),l=r(3),o=e=>new s.default(e.stylesheet.rules).resolve();t.preprocess=((e,t)=>(e.stylesheet.rules=o(e),t())),t.processLint=(e=>(e.stylesheet.rules=o(e),l.lint(e))),t.name="BEM"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(0);class l{constructor(e){this.rules=e}resolve(){let e=[];return this.rules.forEach(t=>{if(l.isNotMediaQuery(t)&&l.isRule(t)){this.flattenRules([t]).map(t=>{e.push(this.getRuleWithBemDeclarations(t))})}else t.rules=this.flattenRules(t.rules),t.rules=t.rules.map(e=>this.getRuleWithBemDeclarations(e)),e.push(t)}),e}flattenRules(e){let t=[];return e?(e.forEach(e=>{e.selectors&&e.selectors.forEach(r=>{const s={type:e.type,selectors:[r],declarations:e.declarations,position:e.position};t.push(s)})}),t):t}static isNotMediaQuery(e){return"media"!==e.type}static isRule(e){return"rule"===e.type}getRuleWithBemDeclarations(e){const t=[];if(e.selectors.forEach(e=>{l.isCssClass(e)&&(e=l.getLastPartOfCssClass(e),t.push(e))}),t.length<1)return e;let r=s.default.parse(t[0]);return(r=l.removeInvalidMatches(r))?(e.declarations=e.declarations.concat(r.map(e=>({type:"declaration",property:"x-should",value:`match '${e}'`}))),e):e}static isCssClass(e){return!!e.match(/(\.\S+)/g)}static removeInvalidMatches(e){return e.filter(e=>!e.match(/\[.+/g))}static getLastPartOfCssClass(e){return"."+e.split(".").filter(Boolean).pop()}}t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(0);t.lint=(e=>{const{rules:t,isBemDetected:r}=l(e);return{rules:t.map(({rule:e,className:t})=>({missingClassName:t,selector:e.selectors[0]||""})),isValid:r&&0===t.length,isBemDetected:r}});const l=e=>{let t=[],r=[],s=[],l=[];return e.stylesheet.rules.forEach(e=>{o(e,t,r,s,l),"media"===e.type&&e.rules.forEach(e=>{o(e,t,r,s,l)})}),{rules:[...new Set(t)],isBemDetected:l.length>0}},o=(e,t,r,l,o)=>{if("rule"===e.type){const a=e.selectors[0],i=[...new Set([].concat(...a.split(".")).filter(e=>e).map(e=>`.${e}`))];l.push(...i),e.declarations.forEach(i=>{if("x-should"===i.property){o.push(a);const n=i.value.match(/(?=\.)(.*)(?=')/g)[0].match(/(\.\S+)/g)[0];if(((e,t,r)=>t.includes(r))(0,l,n))return;if(s.default.isBemModifier(a)&&s.default.isBemBlock(n)){const s=new RegExp(n,"g");a.match(s).length<=1&&(r.push(n),t.push({className:n,rule:e}))}!s.default.isBemBlock(a)||s.default.isBemModifier(n)||s.default.isBemBlock(n)||(r.push(n),t.push({className:n,rule:e}))}})}}}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly8vLi9zcmMvQmVtUGFyc2VyLnRzIiwid2VicGFjazovLy8uL3NyYy9pbmRleC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvUnVsZXNSZXNvbHZlci50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbGludC50cyJdLCJuYW1lcyI6WyJyb290IiwiZmFjdG9yeSIsImV4cG9ydHMiLCJtb2R1bGUiLCJkZWZpbmUiLCJhbWQiLCJhIiwiaSIsIndpbmRvdyIsImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIkJlbVBhcnNlciIsIltvYmplY3QgT2JqZWN0XSIsImNsYXNzTmFtZSIsInBhcnRzIiwiZ2V0UGFydHMiLCJpc0JlbUJsb2NrIiwiZ2V0QmxvY2tQYXJhbSIsImlzQmVtTW9kaWZpZXIiLCJnZXRNb2RpZmllclBhcmFtIiwibWF0Y2giLCJCTE9DS19QQVRURVJOIiwiTU9ESUZJRVJfUEFUVEVSTiIsInNob3VsZEJlUGFydE9mIiwiYmVtVHlwZSIsImdldFBhcmFtIiwic3BsaXQiLCJmaWx0ZXIiLCJCb29sZWFuIiwiZm9yRWFjaCIsInBhcnQiLCJpbmNsdWRlcyIsInB1c2giLCJibG9ja1BhdHRlcm4iLCJtb2RpZmllclBhdHRlcm4iLCJkZWZhdWx0IiwiUnVsZXNSZXNvbHZlcl8xIiwibGludF8xIiwicHJvY2VzcyIsImN0eCIsInN0eWxlc2hlZXQiLCJydWxlcyIsInJlc29sdmUiLCJwcmVwcm9jZXNzIiwibmV4dCIsInByb2Nlc3NMaW50IiwibGludCIsIkJlbVBhcnNlcl8xIiwiUnVsZXNSZXNvbHZlciIsInRoaXMiLCJyZXN1bHQiLCJydWxlIiwiaXNOb3RNZWRpYVF1ZXJ5IiwiaXNSdWxlIiwiZmxhdHRlblJ1bGVzIiwibWFwIiwiZ2V0UnVsZVdpdGhCZW1EZWNsYXJhdGlvbnMiLCJyZXN1bHRzIiwic2VsZWN0b3JzIiwic2VsZWN0b3IiLCJuZXdSdWxlIiwidHlwZSIsImRlY2xhcmF0aW9ucyIsInBvc2l0aW9uIiwic2VsZWN0b3JzV2l0aENzc0NsYXNzIiwiaXNDc3NDbGFzcyIsImdldExhc3RQYXJ0T2ZDc3NDbGFzcyIsImxlbmd0aCIsInBhcmFtcyIsInBhcnNlIiwicmVtb3ZlSW52YWxpZE1hdGNoZXMiLCJjb25jYXQiLCJwYXJhbSIsIm1hdGNoZXMiLCJwb3AiLCJjc3MiLCJpc0JlbURldGVjdGVkIiwiZ2V0SW52YWxpZFJ1bGVzIiwibWlzc2luZ0NsYXNzTmFtZSIsImlzVmFsaWQiLCJpbnZhbGlkUnVsZXMiLCJpbnZhbGlkQ2xhc3NOYW1lcyIsImJlbVNlbGVjdG9ycyIsImRldGVjdE1pc3NpbmdDbGFzc2VzIiwiU2V0IiwiYWxsU2VsZWN0b3JzIiwiZGVjbGFyYXRpb24iLCJpc0NsYXNzTmFtZUV4aXN0SW5Db2xsZWN0aW9uIiwicmVnZXgiLCJSZWdFeHAiXSwibWFwcGluZ3MiOiJDQUFBLFNBQUFBLEVBQUFDLEdBQ0Esb0JBQUFDLFNBQUEsaUJBQUFDLE9BQ0FBLE9BQUFELFFBQUFELFNBQ0Esc0JBQUFHLGVBQUFDLElBQ0FELE9BQUEsR0FBQUgsT0FDQSxDQUNBLElBQUFLLEVBQUFMLElBQ0EsUUFBQU0sS0FBQUQsR0FBQSxpQkFBQUosZ0JBQUFGLEdBQUFPLEdBQUFELEVBQUFDLElBUEEsQ0FTQ0MsT0FBQSxX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QWNMLElBQWVrQyxFQUFBWixRQUFVbkIsV0FBV0gsS0FDakdvRSxFQUFrQmpELEtBQUtuQixHQUN2Qm1FLEVBQWFoRCxLQUFLLENBQUVuQixZQUFXc0MiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXSwgZmFjdG9yeSk7XG5cdGVsc2Uge1xuXHRcdHZhciBhID0gZmFjdG9yeSgpO1xuXHRcdGZvcih2YXIgaSBpbiBhKSAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnID8gZXhwb3J0cyA6IHJvb3QpW2ldID0gYVtpXTtcblx0fVxufSkod2luZG93LCBmdW5jdGlvbigpIHtcbnJldHVybiAiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMSk7XG4iLCJpbXBvcnQgeyBDbGFzc05hbWVUeXBlIH0gZnJvbSAnLi9saW50JztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQmVtUGFyc2VyIHtcbiAgcHJpdmF0ZSBzdGF0aWMgQkxPQ0tfUEFUVEVSTjogUmVnRXhwID0gL1xcUytfX1xcUysvZztcbiAgcHJpdmF0ZSBzdGF0aWMgTU9ESUZJRVJfUEFUVEVSTjogUmVnRXhwID0gL1xcUystLVxcUysvZztcblxuICBwdWJsaWMgc3RhdGljIHBhcnNlKGNsYXNzTmFtZTogQ2xhc3NOYW1lVHlwZSk6IEFycmF5PHN0cmluZz4ge1xuICAgIGxldCBwYXJ0czogQXJyYXk8c3RyaW5nPiA9IFtdO1xuXG4gICAgcGFydHMgPSBCZW1QYXJzZXIuZ2V0UGFydHMoY2xhc3NOYW1lLCBwYXJ0cywgQmVtUGFyc2VyLmlzQmVtQmxvY2soY2xhc3NOYW1lKSwgQmVtUGFyc2VyLmdldEJsb2NrUGFyYW0pO1xuICAgIHBhcnRzID0gQmVtUGFyc2VyLmdldFBhcnRzKGNsYXNzTmFtZSwgcGFydHMsIEJlbVBhcnNlci5pc0JlbU1vZGlmaWVyKGNsYXNzTmFtZSksIEJlbVBhcnNlci5nZXRNb2RpZmllclBhcmFtKTtcblxuICAgIHJldHVybiBwYXJ0cztcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgaXNCZW1CbG9jayhjbGFzc05hbWU6IENsYXNzTmFtZVR5cGUpOiBib29sZWFuIHtcbiAgICByZXR1cm4gISFjbGFzc05hbWUubWF0Y2goQmVtUGFyc2VyLkJMT0NLX1BBVFRFUk4pO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBpc0JlbU1vZGlmaWVyKGNsYXNzTmFtZTogQ2xhc3NOYW1lVHlwZSk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAhIWNsYXNzTmFtZS5tYXRjaChCZW1QYXJzZXIuTU9ESUZJRVJfUEFUVEVSTik7XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBnZXRQYXJ0cyhcbiAgICBjbGFzc05hbWU6IENsYXNzTmFtZVR5cGUsXG4gICAgc2hvdWxkQmVQYXJ0T2Y6IEFycmF5PHN0cmluZz4sXG4gICAgYmVtVHlwZTogYm9vbGVhbixcbiAgICBnZXRQYXJhbTogRnVuY3Rpb24sXG4gICk6IEFycmF5PHN0cmluZz4ge1xuICAgIGlmICghYmVtVHlwZSkge1xuICAgICAgcmV0dXJuIHNob3VsZEJlUGFydE9mO1xuICAgIH1cblxuICAgIGNvbnN0IHBhcnRzOiBBcnJheTxzdHJpbmc+ID0gY2xhc3NOYW1lLnNwbGl0KCcuJykuZmlsdGVyKEJvb2xlYW4pO1xuXG4gICAgcGFydHMuZm9yRWFjaCgocGFydCkgPT4ge1xuICAgICAgcGFydCA9IGdldFBhcmFtKHBhcnQpO1xuXG4gICAgICBpZiAocGFydCAmJiAhc2hvdWxkQmVQYXJ0T2YuaW5jbHVkZXMocGFydCkpIHtcbiAgICAgICAgc2hvdWxkQmVQYXJ0T2YucHVzaChwYXJ0KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBzaG91bGRCZVBhcnRPZjtcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGdldEJsb2NrUGFyYW0oY2xhc3NOYW1lOiBDbGFzc05hbWVUeXBlKTogc3RyaW5nIHtcbiAgICBjb25zdCBibG9ja1BhdHRlcm46IFJlZ0V4cCA9IC9cXFMrPyg/PV9fKS9nO1xuXG4gICAgcmV0dXJuIGNsYXNzTmFtZS5tYXRjaChibG9ja1BhdHRlcm4pICYmICcuJyArIGNsYXNzTmFtZS5tYXRjaChibG9ja1BhdHRlcm4pWzBdICsgJyAqJztcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGdldE1vZGlmaWVyUGFyYW0oY2xhc3NOYW1lOiBDbGFzc05hbWVUeXBlKTogc3RyaW5nIHtcbiAgICBjb25zdCBtb2RpZmllclBhdHRlcm46IFJlZ0V4cCA9IC9cXFMrPyg/PS0tKS9nO1xuXG4gICAgcmV0dXJuIGNsYXNzTmFtZS5tYXRjaChtb2RpZmllclBhdHRlcm4pICYmICcuJyArIGNsYXNzTmFtZS5tYXRjaChtb2RpZmllclBhdHRlcm4pWzBdO1xuICB9XG59XG4iLCJpbXBvcnQgUnVsZXNSZXNvbHZlciBmcm9tICcuL1J1bGVzUmVzb2x2ZXInO1xuaW1wb3J0IHsgUnVsZSwgU3R5bGVzaGVldCB9IGZyb20gJ2Nzcyc7XG5pbXBvcnQgeyBNZWRpYVF1ZXJ5SW50ZXJmYWNlIH0gZnJvbSAnLi9NZWRpYVF1ZXJ5SW50ZXJmYWNlJztcbmltcG9ydCB7IGxpbnQsIExpbnRSdWxlVHlwZSB9IGZyb20gJy4vbGludCc7XG5cbmNvbnN0IHByb2Nlc3MgPSAoY3R4OiBTdHlsZXNoZWV0KTogQXJyYXk8UnVsZSB8IE1lZGlhUXVlcnlJbnRlcmZhY2U+ID0+IHtcbiAgcmV0dXJuIG5ldyBSdWxlc1Jlc29sdmVyKGN0eC5zdHlsZXNoZWV0LnJ1bGVzKS5yZXNvbHZlKCk7XG59O1xuXG5leHBvcnQgY29uc3QgcHJlcHJvY2VzczogRnVuY3Rpb24gPSAoY3R4OiBTdHlsZXNoZWV0LCBuZXh0OiBGdW5jdGlvbik6IEZ1bmN0aW9uID0+IHtcbiAgY3R4LnN0eWxlc2hlZXQucnVsZXMgPSBwcm9jZXNzKGN0eCk7XG5cbiAgcmV0dXJuIG5leHQoKTtcbn07XG5cbmV4cG9ydCBjb25zdCBwcm9jZXNzTGludCA9IChcbiAgY3R4OiBTdHlsZXNoZWV0LFxuKTogeyBydWxlczogQXJyYXk8TGludFJ1bGVUeXBlPjsgaXNWYWxpZDogYm9vbGVhbjsgaXNCZW1EZXRlY3RlZDogYm9vbGVhbiB9ID0+IHtcbiAgY3R4LnN0eWxlc2hlZXQucnVsZXMgPSBwcm9jZXNzKGN0eCk7XG5cbiAgcmV0dXJuIGxpbnQoY3R4KTtcbn07XG5cbmV4cG9ydCBjb25zdCBuYW1lOiBzdHJpbmcgPSAnQkVNJztcbiIsImltcG9ydCBCZW1QYXJzZXIgZnJvbSAnLi9CZW1QYXJzZXInO1xuaW1wb3J0IHsgTWVkaWFRdWVyeUludGVyZmFjZSB9IGZyb20gJy4vTWVkaWFRdWVyeUludGVyZmFjZSc7XG5pbXBvcnQgeyBBdFJ1bGUsIENvbW1lbnQsIFJ1bGUgfSBmcm9tICdjc3MnO1xuaW1wb3J0IHsgU2VsZWN0b3JUeXBlIH0gZnJvbSAnLi9saW50JztcblxuZXhwb3J0IGludGVyZmFjZSBYc2hvdWxkRGVjbGFyYXRpb25JbnRlcmZhY2Uge1xuICB0eXBlOiBzdHJpbmc7XG4gIHByb3BlcnR5OiBzdHJpbmc7XG4gIHZhbHVlOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJ1bGVzUmVzb2x2ZXIge1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJ1bGVzOiBBcnJheTxSdWxlIHwgQ29tbWVudCB8IEF0UnVsZT4pIHt9XG5cbiAgcHVibGljIHJlc29sdmUoKTogQXJyYXk8UnVsZSB8IE1lZGlhUXVlcnlJbnRlcmZhY2U+IHtcbiAgICBsZXQgcmVzdWx0OiBBcnJheTxSdWxlIHwgTWVkaWFRdWVyeUludGVyZmFjZT4gPSBbXTtcblxuICAgIHRoaXMucnVsZXMuZm9yRWFjaChcbiAgICAgIChydWxlOiBhbnkpOiB2b2lkID0+IHtcbiAgICAgICAgaWYgKFJ1bGVzUmVzb2x2ZXIuaXNOb3RNZWRpYVF1ZXJ5KHJ1bGUpICYmIFJ1bGVzUmVzb2x2ZXIuaXNSdWxlKHJ1bGUpKSB7XG4gICAgICAgICAgbGV0IHJ1bGVzID0gdGhpcy5mbGF0dGVuUnVsZXMoW3J1bGVdKTtcblxuICAgICAgICAgIHJ1bGVzLm1hcCgocnVsZSkgPT4ge1xuICAgICAgICAgICAgcmVzdWx0LnB1c2godGhpcy5nZXRSdWxlV2l0aEJlbURlY2xhcmF0aW9ucyhydWxlKSk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBydWxlLnJ1bGVzID0gdGhpcy5mbGF0dGVuUnVsZXMocnVsZS5ydWxlcyk7XG5cbiAgICAgICAgcnVsZS5ydWxlcyA9IHJ1bGUucnVsZXMubWFwKChydWxlKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UnVsZVdpdGhCZW1EZWNsYXJhdGlvbnMocnVsZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJlc3VsdC5wdXNoKHJ1bGUpO1xuICAgICAgfSxcbiAgICApO1xuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHByaXZhdGUgZmxhdHRlblJ1bGVzKHJ1bGVzOiBBcnJheTxSdWxlPik6IEFycmF5PFJ1bGU+IHtcbiAgICBsZXQgcmVzdWx0czogQXJyYXk8UnVsZT4gPSBbXTtcblxuICAgIGlmICghcnVsZXMpIHtcbiAgICAgIHJldHVybiByZXN1bHRzO1xuICAgIH1cblxuICAgIHJ1bGVzLmZvckVhY2goXG4gICAgICAocnVsZSk6IHZvaWQgPT4ge1xuICAgICAgICBpZiAoIXJ1bGUuc2VsZWN0b3JzKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgcnVsZS5zZWxlY3RvcnMuZm9yRWFjaChcbiAgICAgICAgICAoc2VsZWN0b3IpOiB2b2lkID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG5ld1J1bGU6IFJ1bGUgPSB7XG4gICAgICAgICAgICAgIHR5cGU6IHJ1bGUudHlwZSxcbiAgICAgICAgICAgICAgc2VsZWN0b3JzOiBbc2VsZWN0b3JdLFxuICAgICAgICAgICAgICBkZWNsYXJhdGlvbnM6IHJ1bGUuZGVjbGFyYXRpb25zLFxuICAgICAgICAgICAgICBwb3NpdGlvbjogcnVsZS5wb3NpdGlvbixcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHJlc3VsdHMucHVzaChuZXdSdWxlKTtcbiAgICAgICAgICB9LFxuICAgICAgICApO1xuICAgICAgfSxcbiAgICApO1xuXG4gICAgcmV0dXJuIHJlc3VsdHM7XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBpc05vdE1lZGlhUXVlcnkocnVsZTogTWVkaWFRdWVyeUludGVyZmFjZSB8IFJ1bGUpOiBib29sZWFuIHtcbiAgICByZXR1cm4gcnVsZS50eXBlICE9PSAnbWVkaWEnO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgaXNSdWxlKHJ1bGU6IE1lZGlhUXVlcnlJbnRlcmZhY2UgfCBSdWxlKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHJ1bGUudHlwZSA9PT0gJ3J1bGUnO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRSdWxlV2l0aEJlbURlY2xhcmF0aW9ucyhydWxlOiBSdWxlKTogUnVsZSB7XG4gICAgY29uc3Qgc2VsZWN0b3JzV2l0aENzc0NsYXNzOiBBcnJheTxzdHJpbmc+ID0gW107XG5cbiAgICBydWxlLnNlbGVjdG9ycy5mb3JFYWNoKFxuICAgICAgKHNlbGVjdG9yKTogdm9pZCA9PiB7XG4gICAgICAgIGlmIChSdWxlc1Jlc29sdmVyLmlzQ3NzQ2xhc3Moc2VsZWN0b3IpKSB7XG4gICAgICAgICAgc2VsZWN0b3IgPSBSdWxlc1Jlc29sdmVyLmdldExhc3RQYXJ0T2ZDc3NDbGFzcyhzZWxlY3Rvcik7XG4gICAgICAgICAgc2VsZWN0b3JzV2l0aENzc0NsYXNzLnB1c2goc2VsZWN0b3IpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICk7XG5cbiAgICBpZiAoc2VsZWN0b3JzV2l0aENzc0NsYXNzLmxlbmd0aCA8IDEpIHtcbiAgICAgIHJldHVybiBydWxlO1xuICAgIH1cblxuICAgIGxldCBwYXJhbXM6IEFycmF5PHN0cmluZz4gPSBCZW1QYXJzZXIucGFyc2Uoc2VsZWN0b3JzV2l0aENzc0NsYXNzWzBdKTtcblxuICAgIHBhcmFtcyA9IFJ1bGVzUmVzb2x2ZXIucmVtb3ZlSW52YWxpZE1hdGNoZXMocGFyYW1zKTtcblxuICAgIGlmICghcGFyYW1zKSB7XG4gICAgICByZXR1cm4gcnVsZTtcbiAgICB9XG5cbiAgICBydWxlLmRlY2xhcmF0aW9ucyA9IHJ1bGUuZGVjbGFyYXRpb25zLmNvbmNhdChcbiAgICAgIHBhcmFtcy5tYXAoXG4gICAgICAgIChwYXJhbSk6IFhzaG91bGREZWNsYXJhdGlvbkludGVyZmFjZSA9PiB7XG4gICAgICAgICAgcmV0dXJuIHsgdHlwZTogJ2RlY2xhcmF0aW9uJywgcHJvcGVydHk6ICd4LXNob3VsZCcsIHZhbHVlOiBgbWF0Y2ggJyR7cGFyYW19J2AgfTtcbiAgICAgICAgfSxcbiAgICAgICksXG4gICAgKTtcblxuICAgIHJldHVybiBydWxlO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgaXNDc3NDbGFzcyhzZWxlY3RvcjogU2VsZWN0b3JUeXBlKTogYm9vbGVhbiB7XG4gICAgY29uc3QgcGF0dGVybjogUmVnRXhwID0gLyhcXC5cXFMrKS9nO1xuXG4gICAgcmV0dXJuICEhc2VsZWN0b3IubWF0Y2gocGF0dGVybik7XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyByZW1vdmVJbnZhbGlkTWF0Y2hlcyhtYXRjaGVzOiBBcnJheTxzdHJpbmc+KTogQXJyYXk8c3RyaW5nPiB7XG4gICAgcmV0dXJuIG1hdGNoZXMuZmlsdGVyKChtYXRjaCkgPT4gIW1hdGNoLm1hdGNoKC9cXFsuKy9nKSk7XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBnZXRMYXN0UGFydE9mQ3NzQ2xhc3Moc2VsZWN0b3I6IFNlbGVjdG9yVHlwZSk6IHN0cmluZyB7XG4gICAgY29uc3QgcGFydHM6IEFycmF5PHN0cmluZz4gPSBzZWxlY3Rvci5zcGxpdCgnLicpLmZpbHRlcihCb29sZWFuKTtcblxuICAgIHJldHVybiAnLicgKyBwYXJ0cy5wb3AoKTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgTWVkaWEsIFJ1bGUsIFN0eWxlc2hlZXQgfSBmcm9tICdjc3MnO1xuaW1wb3J0IHsgWHNob3VsZERlY2xhcmF0aW9uSW50ZXJmYWNlIH0gZnJvbSAnLi9SdWxlc1Jlc29sdmVyJztcbmltcG9ydCBCZW1QYXJzZXIgZnJvbSAnLi9CZW1QYXJzZXInO1xuXG5leHBvcnQgdHlwZSBDbGFzc05hbWVUeXBlID0gc3RyaW5nO1xudHlwZSBDbGFzc05hbWVzVHlwZSA9IEFycmF5PENsYXNzTmFtZVR5cGU+O1xuZXhwb3J0IHR5cGUgU2VsZWN0b3JUeXBlID0gc3RyaW5nO1xudHlwZSBTZWxlY3RvcnNUeXBlID0gQXJyYXk8U2VsZWN0b3JUeXBlPjtcbmV4cG9ydCB0eXBlIExpbnRSdWxlVHlwZSA9IHsgbWlzc2luZ0NsYXNzTmFtZTogQ2xhc3NOYW1lVHlwZTsgc2VsZWN0b3I6IFNlbGVjdG9yVHlwZSB9O1xuXG5leHBvcnQgY29uc3QgbGludCA9IChjc3M6IFN0eWxlc2hlZXQpOiB7IHJ1bGVzOiBBcnJheTxMaW50UnVsZVR5cGU+OyBpc1ZhbGlkOiBib29sZWFuOyBpc0JlbURldGVjdGVkOiBib29sZWFuIH0gPT4ge1xuICBjb25zdCB7IHJ1bGVzLCBpc0JlbURldGVjdGVkIH0gPSBnZXRJbnZhbGlkUnVsZXMoY3NzKTtcblxuICByZXR1cm4ge1xuICAgIHJ1bGVzOiBydWxlcy5tYXAoKHsgcnVsZSwgY2xhc3NOYW1lIH0pID0+ICh7XG4gICAgICBtaXNzaW5nQ2xhc3NOYW1lOiBjbGFzc05hbWUsXG4gICAgICBzZWxlY3RvcjogcnVsZS5zZWxlY3RvcnNbMF0gfHwgJycsXG4gICAgfSkpLFxuICAgIGlzVmFsaWQ6IGlzQmVtRGV0ZWN0ZWQgJiYgcnVsZXMubGVuZ3RoID09PSAwLFxuICAgIGlzQmVtRGV0ZWN0ZWQsXG4gIH07XG59O1xuXG5jb25zdCBnZXRJbnZhbGlkUnVsZXMgPSAoXG4gIGNzczogU3R5bGVzaGVldCxcbik6IHsgcnVsZXM6IEFycmF5PHsgY2xhc3NOYW1lOiBDbGFzc05hbWVUeXBlOyBydWxlOiBSdWxlIH0+OyBpc0JlbURldGVjdGVkOiBib29sZWFuIH0gPT4ge1xuICBsZXQgaW52YWxpZFJ1bGVzID0gW107XG4gIGxldCBpbnZhbGlkQ2xhc3NOYW1lcyA9IFtdO1xuICBsZXQgc2VsZWN0b3JzID0gW107XG4gIGxldCBiZW1TZWxlY3RvcnMgPSBbXTtcblxuICBjc3Muc3R5bGVzaGVldC5ydWxlcy5mb3JFYWNoKChydWxlOiBSdWxlICYgTWVkaWEpID0+IHtcbiAgICBkZXRlY3RNaXNzaW5nQ2xhc3NlcyhydWxlLCBpbnZhbGlkUnVsZXMsIGludmFsaWRDbGFzc05hbWVzLCBzZWxlY3RvcnMsIGJlbVNlbGVjdG9ycyk7XG5cbiAgICBpZiAocnVsZS50eXBlID09PSAnbWVkaWEnKSB7XG4gICAgICBydWxlLnJ1bGVzLmZvckVhY2goKHJ1bGU6IFJ1bGUpID0+IHtcbiAgICAgICAgZGV0ZWN0TWlzc2luZ0NsYXNzZXMocnVsZSwgaW52YWxpZFJ1bGVzLCBpbnZhbGlkQ2xhc3NOYW1lcywgc2VsZWN0b3JzLCBiZW1TZWxlY3RvcnMpO1xuICAgICAgfSk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4geyBydWxlczogWy4uLm5ldyBTZXQoaW52YWxpZFJ1bGVzKV0sIGlzQmVtRGV0ZWN0ZWQ6IGJlbVNlbGVjdG9ycy5sZW5ndGggPiAwIH07XG59O1xuXG5jb25zdCBpc0NsYXNzTmFtZUV4aXN0SW5Db2xsZWN0aW9uID0gKFxuICBpbnZhbGlkQ2xhc3NOYW1lczogQ2xhc3NOYW1lc1R5cGUsXG4gIHNlbGVjdG9yczogU2VsZWN0b3JzVHlwZSxcbiAgY2xhc3NOYW1lOiBDbGFzc05hbWVUeXBlLFxuKTogYm9vbGVhbiA9PiBzZWxlY3RvcnMuaW5jbHVkZXMoY2xhc3NOYW1lKTtcblxuY29uc3QgZGV0ZWN0TWlzc2luZ0NsYXNzZXMgPSAoXG4gIHJ1bGU6IFJ1bGUsXG4gIGludmFsaWRSdWxlczogQXJyYXk8T2JqZWN0PixcbiAgaW52YWxpZENsYXNzTmFtZXM6IENsYXNzTmFtZXNUeXBlLFxuICBzZWxlY3RvcnM6IFNlbGVjdG9yc1R5cGUsXG4gIGJlbVNlbGVjdG9yczogU2VsZWN0b3JzVHlwZSxcbikgPT4ge1xuICBpZiAocnVsZS50eXBlID09PSAncnVsZScpIHtcbiAgICBjb25zdCBzZWxlY3RvciA9IHJ1bGUuc2VsZWN0b3JzWzBdO1xuXG4gICAgY29uc3QgYWxsU2VsZWN0b3JzOiBBcnJheTxzdHJpbmc+ID0gW1xuICAgICAgLi4ubmV3IFNldChcbiAgICAgICAgW11cbiAgICAgICAgICAuY29uY2F0KC4uLnNlbGVjdG9yLnNwbGl0KCcuJykpXG4gICAgICAgICAgLmZpbHRlcigoY2xhc3NOYW1lKSA9PiBjbGFzc05hbWUpXG4gICAgICAgICAgLm1hcCgoY2xhc3NOYW1lKSA9PiBgLiR7Y2xhc3NOYW1lfWApLFxuICAgICAgKSxcbiAgICBdO1xuICAgIHNlbGVjdG9ycy5wdXNoKC4uLmFsbFNlbGVjdG9ycyk7XG5cbiAgICBydWxlLmRlY2xhcmF0aW9ucy5mb3JFYWNoKChkZWNsYXJhdGlvbjogWHNob3VsZERlY2xhcmF0aW9uSW50ZXJmYWNlKSA9PiB7XG4gICAgICBpZiAoZGVjbGFyYXRpb24ucHJvcGVydHkgPT09ICd4LXNob3VsZCcpIHtcbiAgICAgICAgYmVtU2VsZWN0b3JzLnB1c2goc2VsZWN0b3IpO1xuICAgICAgICBjb25zdCBydWxlRGVjbGFyYXRpb246IFJlZ0V4cE1hdGNoQXJyYXkgPSBkZWNsYXJhdGlvbi52YWx1ZS5tYXRjaCgvKD89XFwuKSguKikoPz0nKS9nKTtcbiAgICAgICAgY29uc3QgY2xhc3NOYW1lc0RlY2xhcmF0aW9uOiBSZWdFeHBNYXRjaEFycmF5ID0gcnVsZURlY2xhcmF0aW9uWzBdLm1hdGNoKC8oXFwuXFxTKykvZyk7XG5cbiAgICAgICAgY29uc3QgY2xhc3NOYW1lID0gY2xhc3NOYW1lc0RlY2xhcmF0aW9uWzBdO1xuXG4gICAgICAgIGlmIChpc0NsYXNzTmFtZUV4aXN0SW5Db2xsZWN0aW9uKGludmFsaWRDbGFzc05hbWVzLCBzZWxlY3RvcnMsIGNsYXNzTmFtZSkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoQmVtUGFyc2VyLmlzQmVtTW9kaWZpZXIoc2VsZWN0b3IpICYmIEJlbVBhcnNlci5pc0JlbUJsb2NrKGNsYXNzTmFtZSkpIHtcbiAgICAgICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoY2xhc3NOYW1lLCAnZycpO1xuICAgICAgICAgIGNvbnN0IG1hdGNoZWQgPSBzZWxlY3Rvci5tYXRjaChyZWdleCk7XG5cbiAgICAgICAgICBpZiAobWF0Y2hlZC5sZW5ndGggPD0gMSkge1xuICAgICAgICAgICAgaW52YWxpZENsYXNzTmFtZXMucHVzaChjbGFzc05hbWUpO1xuICAgICAgICAgICAgaW52YWxpZFJ1bGVzLnB1c2goeyBjbGFzc05hbWUsIHJ1bGUgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKEJlbVBhcnNlci5pc0JlbUJsb2NrKHNlbGVjdG9yKSAmJiAhQmVtUGFyc2VyLmlzQmVtTW9kaWZpZXIoY2xhc3NOYW1lKSAmJiAhQmVtUGFyc2VyLmlzQmVtQmxvY2soY2xhc3NOYW1lKSkge1xuICAgICAgICAgIGludmFsaWRDbGFzc05hbWVzLnB1c2goY2xhc3NOYW1lKTtcbiAgICAgICAgICBpbnZhbGlkUnVsZXMucHVzaCh7IGNsYXNzTmFtZSwgcnVsZSB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9XG59O1xuIl0sInNvdXJjZVJvb3QiOiIifQ==