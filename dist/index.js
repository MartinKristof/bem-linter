!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var s in r)("object"==typeof exports?exports:e)[s]=r[s]}}(window,function(){return function(e){var t={};function r(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(s,o,function(t){return e[t]}.bind(null,o));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(1),o=r(3);t.preprocess=((e,r)=>(e.stylesheet.rules=t.process(e),r())),t.process=(e=>new s.default(e.stylesheet.rules).resolve()),t.processLint=(e=>(e.stylesheet.rules=t.process(e),o.lint(e))),t.name="BEM"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(2);class o{constructor(e){this.rules=e}resolve(){let e=[];return this.rules.forEach(t=>{if(o.isNotMediaQuery(t)&&o.isRule(t)){this.flattenRules([t]).map(t=>{e.push(this.getRuleWithBemDeclarations(t))})}else t.rules=this.flattenRules(t.rules),t.rules=t.rules.map(e=>this.getRuleWithBemDeclarations(e)),e.push(t)}),e}flattenRules(e){let t=[];return e?(e.forEach(e=>{e.selectors&&e.selectors.forEach(r=>{const s={type:e.type,selectors:[r],declarations:e.declarations,position:e.position};t.push(s)})}),t):t}static isNotMediaQuery(e){return"media"!=e.type}static isRule(e){return"rule"==e.type}getRuleWithBemDeclarations(e){const t=[];if(e.selectors.forEach(e=>{o.isCssClass(e)&&(e=o.getLastPartOfCssClass(e),t.push(e))}),t.length<1)return e;const r=s.default.parse(t[0]);return r?(e.declarations=e.declarations.concat(r.map(e=>({type:"declaration",property:"x-should",value:`match '${e}'`}))),e):e}static isCssClass(e){return e.match(/(\.\S+)/g)}static getLastPartOfCssClass(e){return"."+e.split(".").filter(Boolean).pop()}}t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class s{static parse(e){let t=[];return t=s.getParts(e,t,s.isBemBlock(e),s.getBlockParam),t=s.getParts(e,t,s.isBemModifier(e),s.getModifierParam)}static getParts(e,t,r,s){if(!r)return t;return e.split(".").filter(Boolean).forEach(e=>{(e=s(e))&&-1===t.indexOf(e)&&t.push(e)}),t}static getBlockParam(e){const t=/\S+?(?=__)/g;return e.match(t)&&"."+e.match(t)[0]+" *"}static getModifierParam(e){const t=/\S+?(?=--)/g;return e.match(t)&&"."+e.match(t)[0]}static isBemBlock(e){return!!e.match(/\w+__\w+/g)}static isBemModifier(e){return!!e.match(/\w+--\w+/g)}}t.default=s},function(e,t,r){"use strict";function s(e,t,r){"rule"===e.type&&(t.push(e.selectors[0]),e.declarations.forEach(e=>{if("x-should"===e.property){let s=e.value.match(/(?=\.)(.*)(?=')/g)[0].match(/(\.\w+)/g);s[0]&&t.indexOf(s[0])&&-1===r.indexOf(s[0])&&r.push(s[0])}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.lint=function(e){let t=[],r=[];return e.stylesheet.rules.forEach(e=>{s(e,t,r),"media"===e.type&&e.rules.forEach(e=>{s(e,t,r)})}),r.filter(e=>t.indexOf(e)<0)}}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1J1bGVzUmVzb2x2ZXIudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0JlbVBhcnNlci50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbGludC50cyJdLCJuYW1lcyI6WyJyb290IiwiZmFjdG9yeSIsImV4cG9ydHMiLCJtb2R1bGUiLCJkZWZpbmUiLCJhbWQiLCJhIiwiaSIsIndpbmRvdyIsImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIlJ1bGVzUmVzb2x2ZXJfMSIsImxpbnRfMSIsInByZXByb2Nlc3MiLCJjdHgiLCJuZXh0Iiwic3R5bGVzaGVldCIsInJ1bGVzIiwicHJvY2VzcyIsImRlZmF1bHQiLCJyZXNvbHZlIiwicHJvY2Vzc0xpbnQiLCJsaW50IiwiQmVtUGFyc2VyXzEiLCJSdWxlc1Jlc29sdmVyIiwiW29iamVjdCBPYmplY3RdIiwidGhpcyIsInJlc3VsdCIsImZvckVhY2giLCJydWxlIiwiaXNOb3RNZWRpYVF1ZXJ5IiwiaXNSdWxlIiwiZmxhdHRlblJ1bGVzIiwibWFwIiwicHVzaCIsImdldFJ1bGVXaXRoQmVtRGVjbGFyYXRpb25zIiwicmVzdWx0cyIsInNlbGVjdG9ycyIsInNlbGVjdG9yIiwibmV3UnVsZSIsInR5cGUiLCJkZWNsYXJhdGlvbnMiLCJwb3NpdGlvbiIsInNlbGVjdG9yc1dpdGhDc3NDbGFzcyIsImlzQ3NzQ2xhc3MiLCJnZXRMYXN0UGFydE9mQ3NzQ2xhc3MiLCJsZW5ndGgiLCJwYXJhbXMiLCJwYXJzZSIsImNvbmNhdCIsInBhcmFtIiwibWF0Y2giLCJzcGxpdCIsImZpbHRlciIsIkJvb2xlYW4iLCJwb3AiLCJCZW1QYXJzZXIiLCJjbGFzc05hbWUiLCJzaG91bGRCZVBhcnRPZiIsImdldFBhcnRzIiwiaXNCZW1CbG9jayIsImdldEJsb2NrUGFyYW0iLCJpc0JlbU1vZGlmaWVyIiwiZ2V0TW9kaWZpZXJQYXJhbSIsImJlbVR5cGUiLCJnZXRQYXJhbSIsInBhcnQiLCJpbmRleE9mIiwiYmxvY2tQYXR0ZXJuIiwibW9kaWZpZXJQYXR0ZXJuIiwiZGV0ZWN0TWlzc2luZ0NsYXNzZXMiLCJmb3VuZENsYXNzZXMiLCJkZWNsYXJhdGlvbiIsImNzcyJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBQUEsRUFBQUMsR0FDQSxvQkFBQUMsU0FBQSxpQkFBQUMsT0FDQUEsT0FBQUQsUUFBQUQsU0FDQSxzQkFBQUcsZUFBQUMsSUFDQUQsT0FBQSxHQUFBSCxPQUNBLENBQ0EsSUFBQUssRUFBQUwsSUFDQSxRQUFBTSxLQUFBRCxHQUFBLGlCQUFBSixnQkFBQUYsR0FBQU8sR0FBQUQsRUFBQUMsSUFQQSxDQVNDQyxPQUFBLFdBQ0QsbUJDVEEsSUFBQUMsRUFBQSxHQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBVCxRQUdBLElBQUFDLEVBQUFNLEVBQUFFLEdBQUEsQ0FDQUosRUFBQUksRUFDQUMsR0FBQSxFQUNBVixRQUFBLElBVUEsT0FOQVcsRUFBQUYsR0FBQUcsS0FBQVgsRUFBQUQsUUFBQUMsSUFBQUQsUUFBQVEsR0FHQVAsRUFBQVMsR0FBQSxFQUdBVCxFQUFBRCxRQTBEQSxPQXJEQVEsRUFBQUssRUFB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YyxHQUFLLEtBRzNFM0Msd0JBQXdCZ0MsR0FDOUIsTUFBTVksRUFBMEIsY0FFaEMsT0FBT1osRUFBVU4sTUFBTWtCLElBQW9CLElBQU1aLEVBQVVOLE1BQU1rQixHQUFpQixHQUc1RTVDLGtCQUFrQmdDLEdBR3hCLFFBQU9BLEVBQVVOLE1BRlksYUFLdkIxQixxQkFBcUJnQyxHQUczQixRQUFPQSxFQUFVTixNQUZlLGNBL0RwQ2pGLEVBQUFpRCxRQUFBcUMsZ0NDc0JBLFNBQUFjLEVBQThCekMsRUFBWVEsRUFBMEJrQyxHQUNoRCxTQUFkMUMsRUFBS1csT0FDUEgsRUFBVUgsS0FBS0wsRUFBS1EsVUFBVSxJQUM5QlIsRUFBS1ksYUFBYWIsUUFBUzRDLElBQ3pCLEdBQTZCLGFBQXpCQSxFQUFZbEUsU0FBeUIsQ0FDdkMsSUFDSW1ELEVBRG9DZSxFQUFZNUUsTUFBTXVELE1BQU0sb0JBQ2QsR0FBR0EsTUFBTSxZQUV2RE0sRUFBVSxJQUNScEIsRUFBVThCLFFBQVFWLEVBQVUsTUFDVSxJQUF4Q2MsRUFBYUosUUFBUVYsRUFBVSxLQUFjYyxFQUFhckMsS0FBS3VCLEVBQVUseURBN0JyRnZGLEVBQUFvRCxLQUFBLFNBQXFCbUQsR0FDbkIsSUFBSXBDLEVBQTJCLEdBQzNCa0MsRUFBOEIsR0FZbEMsT0FWQUUsRUFBSXpELFdBQVdDLE1BQU1XLFFBQVNDLElBQzVCeUMsRUFBcUJ6QyxFQUFNUSxFQUFXa0MsR0FFcEIsVUFBZDFDLEVBQUtXLE1BQ1BYLEVBQUtaLE1BQU1XLFFBQVNDLElBQ2xCeUMsRUFBcUJ6QyxFQUFNUSxFQUFXa0MsT0FLckNBLEVBQWFsQixPQUFROUUsR0FDbkI4RCxFQUFVOEIsUUFBUTVGLEdBQUsiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXSwgZmFjdG9yeSk7XG5cdGVsc2Uge1xuXHRcdHZhciBhID0gZmFjdG9yeSgpO1xuXHRcdGZvcih2YXIgaSBpbiBhKSAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnID8gZXhwb3J0cyA6IHJvb3QpW2ldID0gYVtpXTtcblx0fVxufSkod2luZG93LCBmdW5jdGlvbigpIHtcbnJldHVybiAiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCJpbXBvcnQgUnVsZXNSZXNvbHZlciBmcm9tICcuL1J1bGVzUmVzb2x2ZXInO1xuaW1wb3J0IHsgUnVsZSwgU3R5bGVzaGVldCB9IGZyb20gJ2Nzcyc7XG5pbXBvcnQgeyBNZWRpYVF1ZXJ5SW50ZXJmYWNlIH0gZnJvbSAnLi9NZWRpYVF1ZXJ5SW50ZXJmYWNlJztcbmltcG9ydCB7IGxpbnQgfSBmcm9tICcuL2xpbnQnO1xuXG5leHBvcnQgY29uc3QgcHJlcHJvY2VzczogRnVuY3Rpb24gPSAoY3R4OiBTdHlsZXNoZWV0LCBuZXh0OiBGdW5jdGlvbik6IEZ1bmN0aW9uID0+IHtcbiAgY3R4LnN0eWxlc2hlZXQucnVsZXMgPSBwcm9jZXNzKGN0eCk7XG5cbiAgcmV0dXJuIG5leHQoKTtcbn07XG5cbmV4cG9ydCBjb25zdCBwcm9jZXNzID0gKGN0eDogU3R5bGVzaGVldCk6IEFycmF5PFJ1bGUgfCBNZWRpYVF1ZXJ5SW50ZXJmYWNlPiA9PiB7XG4gIHJldHVybiBuZXcgUnVsZXNSZXNvbHZlcihjdHguc3R5bGVzaGVldC5ydWxlcykucmVzb2x2ZSgpO1xufTtcblxuZXhwb3J0IGNvbnN0IHByb2Nlc3NMaW50ID0gKGN0eDogU3R5bGVzaGVldCk6IEFycmF5PHN0cmluZz4gPT4ge1xuICBjdHguc3R5bGVzaGVldC5ydWxlcyA9IHByb2Nlc3MoY3R4KTtcblxuICByZXR1cm4gbGludChjdHgpO1xufTtcblxuZXhwb3J0IGNvbnN0IG5hbWU6IHN0cmluZyA9ICdCRU0nO1xuIiwiaW1wb3J0IEJlbVBhcnNlciBmcm9tICcuL0JlbVBhcnNlcic7XG5pbXBvcnQgeyBNZWRpYVF1ZXJ5SW50ZXJmYWNlIH0gZnJvbSAnLi9NZWRpYVF1ZXJ5SW50ZXJmYWNlJztcbmltcG9ydCB7IEF0UnVsZSwgQ29tbWVudCwgUnVsZSB9IGZyb20gJ2Nzcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgWHNob3VsZERlY2xhcmF0aW9uSW50ZXJmYWNlIHtcbiAgdHlwZTogc3RyaW5nO1xuICBwcm9wZXJ0eTogc3RyaW5nO1xuICB2YWx1ZTogc3RyaW5nO1xufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSdWxlc1Jlc29sdmVyIHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSBydWxlczogQXJyYXk8UnVsZSB8IENvbW1lbnQgfCBBdFJ1bGU+KSB7fVxuXG4gIHB1YmxpYyByZXNvbHZlKCk6IEFycmF5PFJ1bGUgfCBNZWRpYVF1ZXJ5SW50ZXJmYWNlPiB7XG4gICAgbGV0IHJlc3VsdDogQXJyYXk8UnVsZSB8IE1lZGlhUXVlcnlJbnRlcmZhY2U+ID0gW107XG5cbiAgICB0aGlzLnJ1bGVzLmZvckVhY2goXG4gICAgICAocnVsZTogYW55KTogdm9pZCA9PiB7XG4gICAgICAgIGlmIChSdWxlc1Jlc29sdmVyLmlzTm90TWVkaWFRdWVyeShydWxlKSAmJiBSdWxlc1Jlc29sdmVyLmlzUnVsZShydWxlKSkge1xuICAgICAgICAgIGxldCBydWxlcyA9IHRoaXMuZmxhdHRlblJ1bGVzKFtydWxlXSk7XG5cbiAgICAgICAgICBydWxlcy5tYXAoKHJ1bGUpID0+IHtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKHRoaXMuZ2V0UnVsZVdpdGhCZW1EZWNsYXJhdGlvbnMocnVsZSkpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgcnVsZS5ydWxlcyA9IHRoaXMuZmxhdHRlblJ1bGVzKHJ1bGUucnVsZXMpO1xuXG4gICAgICAgIHJ1bGUucnVsZXMgPSBydWxlLnJ1bGVzLm1hcCgocnVsZSkgPT4ge1xuICAgICAgICAgIHJldHVybiB0aGlzLmdldFJ1bGVXaXRoQmVtRGVjbGFyYXRpb25zKHJ1bGUpO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXN1bHQucHVzaChydWxlKTtcbiAgICAgIH0sXG4gICAgKTtcblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBwcml2YXRlIGZsYXR0ZW5SdWxlcyhydWxlczogQXJyYXk8UnVsZT4pOiBBcnJheTxSdWxlPiB7XG4gICAgbGV0IHJlc3VsdHM6IEFycmF5PFJ1bGU+ID0gW107XG5cbiAgICBpZiAoIXJ1bGVzKSB7XG4gICAgICByZXR1cm4gcmVzdWx0cztcbiAgICB9XG5cbiAgICBydWxlcy5mb3JFYWNoKFxuICAgICAgKHJ1bGUpOiB2b2lkID0+IHtcbiAgICAgICAgaWYgKCFydWxlLnNlbGVjdG9ycykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJ1bGUuc2VsZWN0b3JzLmZvckVhY2goXG4gICAgICAgICAgKHNlbGVjdG9yKTogdm9pZCA9PiB7XG4gICAgICAgICAgICBjb25zdCBuZXdSdWxlOiBSdWxlID0ge1xuICAgICAgICAgICAgICB0eXBlOiBydWxlLnR5cGUsXG4gICAgICAgICAgICAgIHNlbGVjdG9yczogW3NlbGVjdG9yXSxcbiAgICAgICAgICAgICAgZGVjbGFyYXRpb25zOiBydWxlLmRlY2xhcmF0aW9ucyxcbiAgICAgICAgICAgICAgcG9zaXRpb246IHJ1bGUucG9zaXRpb24sXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICByZXN1bHRzLnB1c2gobmV3UnVsZSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgKTtcbiAgICAgIH0sXG4gICAgKTtcblxuICAgIHJldHVybiByZXN1bHRzO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgaXNOb3RNZWRpYVF1ZXJ5KHJ1bGU6IE1lZGlhUXVlcnlJbnRlcmZhY2UgfCBSdWxlKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHJ1bGUudHlwZSAhPSAnbWVkaWEnO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgaXNSdWxlKHJ1bGU6IE1lZGlhUXVlcnlJbnRlcmZhY2UgfCBSdWxlKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHJ1bGUudHlwZSA9PSAncnVsZSc7XG4gIH1cblxuICBwcml2YXRlIGdldFJ1bGVXaXRoQmVtRGVjbGFyYXRpb25zKHJ1bGU6IFJ1bGUpOiBSdWxlIHtcbiAgICBjb25zdCBzZWxlY3RvcnNXaXRoQ3NzQ2xhc3M6IEFycmF5PHN0cmluZz4gPSBbXTtcblxuICAgIHJ1bGUuc2VsZWN0b3JzLmZvckVhY2goXG4gICAgICAoc2VsZWN0b3IpOiB2b2lkID0+IHtcbiAgICAgICAgaWYgKFJ1bGVzUmVzb2x2ZXIuaXNDc3NDbGFzcyhzZWxlY3RvcikpIHtcbiAgICAgICAgICBzZWxlY3RvciA9IFJ1bGVzUmVzb2x2ZXIuZ2V0TGFzdFBhcnRPZkNzc0NsYXNzKHNlbGVjdG9yKTtcbiAgICAgICAgICBzZWxlY3RvcnNXaXRoQ3NzQ2xhc3MucHVzaChzZWxlY3Rvcik7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgKTtcblxuICAgIGlmIChzZWxlY3RvcnNXaXRoQ3NzQ2xhc3MubGVuZ3RoIDwgMSkge1xuICAgICAgcmV0dXJuIHJ1bGU7XG4gICAgfVxuXG4gICAgY29uc3QgcGFyYW1zOiBBcnJheTxzdHJpbmc+ID0gQmVtUGFyc2VyLnBhcnNlKHNlbGVjdG9yc1dpdGhDc3NDbGFzc1swXSk7XG5cbiAgICBpZiAoIXBhcmFtcykge1xuICAgICAgcmV0dXJuIHJ1bGU7XG4gICAgfVxuXG4gICAgcnVsZS5kZWNsYXJhdGlvbnMgPSBydWxlLmRlY2xhcmF0aW9ucy5jb25jYXQoXG4gICAgICBwYXJhbXMubWFwKFxuICAgICAgICAocGFyYW0pOiBYc2hvdWxkRGVjbGFyYXRpb25JbnRlcmZhY2UgPT4ge1xuICAgICAgICAgIHJldHVybiB7IHR5cGU6ICdkZWNsYXJhdGlvbicsIHByb3BlcnR5OiAneC1zaG91bGQnLCB2YWx1ZTogYG1hdGNoICcke3BhcmFtfSdgIH07XG4gICAgICAgIH0sXG4gICAgICApLFxuICAgICk7XG5cbiAgICByZXR1cm4gcnVsZTtcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGlzQ3NzQ2xhc3Moc2VsZWN0b3I6IHN0cmluZyk6IFJlZ0V4cE1hdGNoQXJyYXkge1xuICAgIGNvbnN0IHBhdHRlcm46IFJlZ0V4cCA9IC8oXFwuXFxTKykvZztcblxuICAgIHJldHVybiBzZWxlY3Rvci5tYXRjaChwYXR0ZXJuKTtcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGdldExhc3RQYXJ0T2ZDc3NDbGFzcyhzZWxlY3Rvcjogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCBwYXJ0czogQXJyYXk8c3RyaW5nPiA9IHNlbGVjdG9yLnNwbGl0KCcuJykuZmlsdGVyKEJvb2xlYW4pO1xuXG4gICAgcmV0dXJuICcuJyArIHBhcnRzLnBvcCgpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBCZW1QYXJzZXIge1xuICBwdWJsaWMgc3RhdGljIHBhcnNlKGNsYXNzTmFtZTogc3RyaW5nKTogQXJyYXk8c3RyaW5nPiB7XG4gICAgbGV0IHNob3VsZEJlUGFydE9mOiBBcnJheTxzdHJpbmc+ID0gW107XG5cbiAgICBzaG91bGRCZVBhcnRPZiA9IEJlbVBhcnNlci5nZXRQYXJ0cyhcbiAgICAgIGNsYXNzTmFtZSxcbiAgICAgIHNob3VsZEJlUGFydE9mLFxuICAgICAgQmVtUGFyc2VyLmlzQmVtQmxvY2soY2xhc3NOYW1lKSxcbiAgICAgIEJlbVBhcnNlci5nZXRCbG9ja1BhcmFtLFxuICAgICk7XG5cbiAgICBzaG91bGRCZVBhcnRPZiA9IEJlbVBhcnNlci5nZXRQYXJ0cyhcbiAgICAgIGNsYXNzTmFtZSxcbiAgICAgIHNob3VsZEJlUGFydE9mLFxuICAgICAgQmVtUGFyc2VyLmlzQmVtTW9kaWZpZXIoY2xhc3NOYW1lKSxcbiAgICAgIEJlbVBhcnNlci5nZXRNb2RpZmllclBhcmFtLFxuICAgICk7XG5cbiAgICByZXR1cm4gc2hvdWxkQmVQYXJ0T2Y7XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBnZXRQYXJ0cyhcbiAgICBjbGFzc05hbWU6IHN0cmluZyxcbiAgICBzaG91bGRCZVBhcnRPZjogQXJyYXk8c3RyaW5nPixcbiAgICBiZW1UeXBlOiBib29sZWFuLFxuICAgIGdldFBhcmFtOiBGdW5jdGlvbixcbiAgKTogQXJyYXk8c3RyaW5nPiB7XG4gICAgaWYgKCFiZW1UeXBlKSB7XG4gICAgICByZXR1cm4gc2hvdWxkQmVQYXJ0T2Y7XG4gICAgfVxuXG4gICAgY29uc3QgcGFydHM6IEFycmF5PHN0cmluZz4gPSBjbGFzc05hbWUuc3BsaXQoJy4nKS5maWx0ZXIoQm9vbGVhbik7XG5cbiAgICBwYXJ0cy5mb3JFYWNoKChwYXJ0KSA9PiB7XG4gICAgICBwYXJ0ID0gZ2V0UGFyYW0ocGFydCk7XG5cbiAgICAgIGlmIChwYXJ0ICYmIHNob3VsZEJlUGFydE9mLmluZGV4T2YocGFydCkgPT09IC0xKSB7XG4gICAgICAgIHNob3VsZEJlUGFydE9mLnB1c2gocGFydCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gc2hvdWxkQmVQYXJ0T2Y7XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBnZXRCbG9ja1BhcmFtKGNsYXNzTmFtZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCBibG9ja1BhdHRlcm46IFJlZ0V4cCA9IC9cXFMrPyg/PV9fKS9nO1xuXG4gICAgcmV0dXJuIGNsYXNzTmFtZS5tYXRjaChibG9ja1BhdHRlcm4pICYmICcuJyArIGNsYXNzTmFtZS5tYXRjaChibG9ja1BhdHRlcm4pWzBdICsgJyAqJztcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGdldE1vZGlmaWVyUGFyYW0oY2xhc3NOYW1lOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IG1vZGlmaWVyUGF0dGVybjogUmVnRXhwID0gL1xcUys/KD89LS0pL2c7XG5cbiAgICByZXR1cm4gY2xhc3NOYW1lLm1hdGNoKG1vZGlmaWVyUGF0dGVybikgJiYgJy4nICsgY2xhc3NOYW1lLm1hdGNoKG1vZGlmaWVyUGF0dGVybilbMF07XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBpc0JlbUJsb2NrKGNsYXNzTmFtZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgY29uc3QgYmxvY2tQYXR0ZXJuOiBSZWdFeHAgPSAvXFx3K19fXFx3Ky9nO1xuXG4gICAgcmV0dXJuIGNsYXNzTmFtZS5tYXRjaChibG9ja1BhdHRlcm4pID8gdHJ1ZSA6IGZhbHNlO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgaXNCZW1Nb2RpZmllcihjbGFzc05hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IG1vZGlmaWVyUGF0dGVybjogUmVnRXhwID0gL1xcdystLVxcdysvZztcblxuICAgIHJldHVybiBjbGFzc05hbWUubWF0Y2gobW9kaWZpZXJQYXR0ZXJuKSA/IHRydWUgOiBmYWxzZTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgTWVkaWEsIFJ1bGUsIFN0eWxlc2hlZXQgfSBmcm9tICdjc3MnO1xuaW1wb3J0IHsgWHNob3VsZERlY2xhcmF0aW9uSW50ZXJmYWNlIH0gZnJvbSAnLi9SdWxlc1Jlc29sdmVyJztcblxuZXhwb3J0IGZ1bmN0aW9uIGxpbnQoY3NzOiBTdHlsZXNoZWV0KTogQXJyYXk8c3RyaW5nPiB7XG4gIGxldCBzZWxlY3RvcnM6IEFycmF5PHN0cmluZz4gPSBbXTtcbiAgbGV0IGZvdW5kQ2xhc3NlczogQXJyYXk8c3RyaW5nPiA9IFtdO1xuXG4gIGNzcy5zdHlsZXNoZWV0LnJ1bGVzLmZvckVhY2goKHJ1bGU6IFJ1bGUgJiBNZWRpYSkgPT4ge1xuICAgIGRldGVjdE1pc3NpbmdDbGFzc2VzKHJ1bGUsIHNlbGVjdG9ycywgZm91bmRDbGFzc2VzKTtcblxuICAgIGlmIChydWxlLnR5cGUgPT09ICdtZWRpYScpIHtcbiAgICAgIHJ1bGUucnVsZXMuZm9yRWFjaCgocnVsZTogUnVsZSkgPT4ge1xuICAgICAgICBkZXRlY3RNaXNzaW5nQ2xhc3NlcyhydWxlLCBzZWxlY3RvcnMsIGZvdW5kQ2xhc3Nlcyk7XG4gICAgICB9KTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBmb3VuZENsYXNzZXMuZmlsdGVyKChpOiBzdHJpbmcpID0+IHtcbiAgICByZXR1cm4gc2VsZWN0b3JzLmluZGV4T2YoaSkgPCAwO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gZGV0ZWN0TWlzc2luZ0NsYXNzZXMocnVsZTogUnVsZSwgc2VsZWN0b3JzOiBBcnJheTxPYmplY3Q+LCBmb3VuZENsYXNzZXM6IEFycmF5PHN0cmluZz4pIHtcbiAgaWYgKHJ1bGUudHlwZSA9PT0gJ3J1bGUnKSB7XG4gICAgc2VsZWN0b3JzLnB1c2gocnVsZS5zZWxlY3RvcnNbMF0pO1xuICAgIHJ1bGUuZGVjbGFyYXRpb25zLmZvckVhY2goKGRlY2xhcmF0aW9uOiBYc2hvdWxkRGVjbGFyYXRpb25JbnRlcmZhY2UpID0+IHtcbiAgICAgIGlmIChkZWNsYXJhdGlvbi5wcm9wZXJ0eSA9PT0gJ3gtc2hvdWxkJykge1xuICAgICAgICBsZXQgcnVsZURlY2xhcmF0aW9uOiBSZWdFeHBNYXRjaEFycmF5ID0gZGVjbGFyYXRpb24udmFsdWUubWF0Y2goLyg/PVxcLikoLiopKD89JykvZyk7XG4gICAgICAgIGxldCBjbGFzc05hbWU6IFJlZ0V4cE1hdGNoQXJyYXkgPSBydWxlRGVjbGFyYXRpb25bMF0ubWF0Y2goLyhcXC5cXHcrKS9nKTtcblxuICAgICAgICBpZiAoY2xhc3NOYW1lWzBdKSB7XG4gICAgICAgICAgaWYgKHNlbGVjdG9ycy5pbmRleE9mKGNsYXNzTmFtZVswXSkpIHtcbiAgICAgICAgICAgIGZvdW5kQ2xhc3Nlcy5pbmRleE9mKGNsYXNzTmFtZVswXSkgPT09IC0xICYmIGZvdW5kQ2xhc3Nlcy5wdXNoKGNsYXNzTmFtZVswXSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=