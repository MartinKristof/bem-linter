!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var s in r)("object"==typeof exports?exports:e)[s]=r[s]}}(window,function(){return function(e){var t={};function r(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return e[s].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(s,i,function(t){return e[t]}.bind(null,i));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class s{static parse(e){let t=[];return t=s.getParts(e,t,s.isBemBlock(e),s.getBlockParam),t=s.getParts(e,t,s.isBemModifier(e),s.getModifierParam)}static isBemBlock(e){return!!e.match(s.BLOCK_PATTERN)}static isBemModifier(e){return!!e.match(s.MODIFIER_PATTERN)}static getParts(e,t,r,s){if(!r)return t;return e.split(".").filter(Boolean).forEach(e=>{(e=s(e))&&!t.includes(e)&&t.push(e)}),t}static getBlockParam(e){const t=/\S+?(?=__)/g;return e.match(t)&&"."+e.match(t)[0]+" *"}static getModifierParam(e){const t=/\S+?(?=--)/g;return e.match(t)&&"."+e.match(t)[0]}}s.BLOCK_PATTERN=/\S+__\S+/g,s.MODIFIER_PATTERN=/\S+--\S+/g,t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(2),i=r(3),l=e=>new s.default(e.stylesheet.rules).resolve();t.preprocess=((e,t)=>(e.stylesheet.rules=l(e),t())),t.processLint=(e=>(e.stylesheet.rules=l(e),i.lint(e))),t.name="BEM"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(0);class i{constructor(e){this.rules=e}resolve(){let e=[];return this.rules.forEach(t=>{if(i.isNotMediaQuery(t)&&i.isRule(t)){this.flattenRules([t]).map(t=>{e.push(this.getRuleWithBemDeclarations(t))})}else t.rules=this.flattenRules(t.rules),t.rules=t.rules.map(e=>this.getRuleWithBemDeclarations(e)),e.push(t)}),e}flattenRules(e){let t=[];return e?(e.forEach(e=>{e.selectors&&e.selectors.forEach(r=>{const s={type:e.type,selectors:[r],declarations:e.declarations,position:e.position};t.push(s)})}),t):t}static isNotMediaQuery(e){return"media"!==e.type}static isRule(e){return"rule"===e.type}getRuleWithBemDeclarations(e){const t=[];if(e.selectors.forEach(e=>{i.isCssClass(e)&&(e=i.getLastPartOfCssClass(e),t.push(e))}),t.length<1)return e;let r=s.default.parse(t[0]);return(r=i.removeInvalidMatches(r))?(e.declarations=e.declarations.concat(r.map(e=>({type:"declaration",property:"x-should",value:`match '${e}'`}))),e):e}static isCssClass(e){return!!e.match(/(\.\S+)/g)}static removeInvalidMatches(e){return e.filter(e=>!e.match(/\[.+/g))}static getLastPartOfCssClass(e){return"."+e.split(".").filter(Boolean).pop()}}t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(0);t.lint=(e=>{const{rules:t,isBemDetected:r}=i(e);return{rules:t.map(({rule:e,className:t})=>({missingClassName:t,selector:e.selectors[0]||""})),isValid:r&&0===t.length,isBemDetected:r}});const i=e=>{let t=[],r=[],s=[],i=[];return e.stylesheet.rules.forEach(e=>{l(e,t,r,s,i),"media"===e.type&&e.rules.forEach(e=>{l(e,t,r,s,i)})}),{rules:[...new Set(t)],isBemDetected:i.length>0}},l=(e,t,r,i,l)=>{if("rule"===e.type){const o=e.selectors[0],a=[...new Set([].concat(...o.split(".")).filter(e=>e).map(e=>`.${e}`))];i.push(...a),e.declarations.forEach(a=>{if("x-should"===a.property){l.push(o);const n=a.value.match(/(?=\.)(.*)(?=')/g)[0].match(/(\.\S+)/g)[0];if(((e,t,r)=>t.includes(r))(0,i,n))return;if(s.default.isBemModifier(o)&&s.default.isBemBlock(n)){const s=new RegExp(n,"g");if(o.match(s).length<=1)return r.push(n),void t.push({className:n,rule:e})}if(s.default.isBemBlock(o)&&!s.default.isBemModifier(n)&&!s.default.isBemBlock(n))return r.push(n),void t.push({className:n,rule:e});if(s.default.isBemModifier(o))return r.push(n),void t.push({className:n,rule:e})}})}}}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly8vLi9zcmMvQmVtUGFyc2VyLnRzIiwid2VicGFjazovLy8uL3NyYy9pbmRleC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvUnVsZXNSZXNvbHZlci50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbGludC50cyJdLCJuYW1lcyI6WyJyb290IiwiZmFjdG9yeSIsImV4cG9ydHMiLCJtb2R1bGUiLCJkZWZpbmUiLCJhbWQiLCJhIiwiaSIsIndpbmRvdyIsImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIkJlbVBhcnNlciIsIltvYmplY3QgT2JqZWN0XSIsImNsYXNzTmFtZSIsInBhcnRzIiwiZ2V0UGFydHMiLCJpc0JlbUJsb2NrIiwiZ2V0QmxvY2tQYXJhbSIsImlzQmVtTW9kaWZpZXIiLCJnZXRNb2RpZmllclBhcmFtIiwibWF0Y2giLCJCTE9DS19QQVRURVJOIiwiTU9ESUZJRVJfUEFUVEVSTiIsInNob3VsZEJlUGFydE9mIiwiYmVtVHlwZSIsImdldFBhcmFtIiwic3BsaXQiLCJmaWx0ZXIiLCJCb29sZWFuIiwiZm9yRWFjaCIsInBhcnQiLCJpbmNsdWRlcyIsInB1c2giLCJibG9ja1BhdHRlcm4iLCJtb2RpZmllclBhdHRlcm4iLCJkZWZhdWx0IiwiUnVsZXNSZXNvbHZlcl8xIiwibGludF8xIiwicHJvY2VzcyIsImN0eCIsInN0eWxlc2hlZXQiLCJydWxlcyIsInJlc29sdmUiLCJwcmVwcm9jZXNzIiwibmV4dCIsInByb2Nlc3NMaW50IiwibGludCIsIkJlbVBhcnNlcl8xIiwiUnVsZXNSZXNvbHZlciIsInRoaXMiLCJyZXN1bHQiLCJydWxlIiwiaXNOb3RNZWRpYVF1ZXJ5IiwiaXNSdWxlIiwiZmxhdHRlblJ1bGVzIiwibWFwIiwiZ2V0UnVsZVdpdGhCZW1EZWNsYXJhdGlvbnMiLCJyZXN1bHRzIiwic2VsZWN0b3JzIiwic2VsZWN0b3IiLCJuZXdSdWxlIiwidHlwZSIsImRlY2xhcmF0aW9ucyIsInBvc2l0aW9uIiwic2VsZWN0b3JzV2l0aENzc0NsYXNzIiwiaXNDc3NDbGFzcyIsImdldExhc3RQYXJ0T2ZDc3NDbGFzcyIsImxlbmd0aCIsInBhcmFtcyIsInBhcnNlIiwicmVtb3ZlSW52YWxpZE1hdGNoZXMiLCJjb25jYXQiLCJwYXJhbSIsIm1hdGNoZXMiLCJwb3AiLCJjc3MiLCJpc0JlbURldGVjdGVkIiwiZ2V0SW52YWxpZFJ1bGVzIiwibWlzc2luZ0NsYXNzTmFtZSIsImlzVmFsaWQiLCJpbnZhbGlkUnVsZXMiLCJpbnZhbGlkQ2xhc3NOYW1lcyIsImJlbVNlbGVjdG9ycyIsImRldGVjdE1pc3NpbmdDbGFzc2VzIiwiU2V0IiwiYWxsU2VsZWN0b3JzIiwiZGVjbGFyYXRpb24iLCJpc0NsYXNzTmFtZUV4aXN0SW5Db2xsZWN0aW9uIiwicmVnZXgiLCJSZWdFeHAiXSwibWFwcGluZ3MiOiJDQUFBLFNBQUFBLEVBQUFDLEdBQ0Esb0JBQUFDLFNBQUEsaUJBQUFDLE9BQ0FBLE9BQUFELFFBQUFELFNBQ0Esc0JBQUFHLGVBQUFDLElBQ0FELE9BQUEsR0FBQUgsT0FDQSxDQUNBLElBQUFLLEVBQUFMLElBQ0EsUUFBQU0sS0FBQUQsR0FBQSxpQkFBQUosZ0JBQUFGLEdBQUFPLEdBQUFELEVBQUFDLElBUEEsQ0FTQ0MsT0FBQSxX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LEVBQUFaLFFBQVVqQixjQUFjTCxLQUFla0MsRUFBQVosUUFBVW5CLFdBQVdILEdBSWpHLE9BSEFvRSxFQUFrQmpELEtBQUtuQixRQUN2Qm1FLEVBQWFoRCxLQUFLLENBQUVuQixZQUFXc0MsU0FLakMsR0FBSUosRUFBQVosUUFBVWpCLGNBQWN5QyxHQUkxQixPQUhBc0IsRUFBa0JqRCxLQUFLbkIsUUFDdkJtRSxFQUFhaEQsS0FBSyxDQUFFbkIsWUFBV3NDIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoW10sIGZhY3RvcnkpO1xuXHRlbHNlIHtcblx0XHR2YXIgYSA9IGZhY3RvcnkoKTtcblx0XHRmb3IodmFyIGkgaW4gYSkgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyA/IGV4cG9ydHMgOiByb290KVtpXSA9IGFbaV07XG5cdH1cbn0pKHdpbmRvdywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDEpO1xuIiwiaW1wb3J0IHsgQ2xhc3NOYW1lVHlwZSB9IGZyb20gJy4vbGludCc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEJlbVBhcnNlciB7XG4gIHByaXZhdGUgc3RhdGljIEJMT0NLX1BBVFRFUk46IFJlZ0V4cCA9IC9cXFMrX19cXFMrL2c7XG4gIHByaXZhdGUgc3RhdGljIE1PRElGSUVSX1BBVFRFUk46IFJlZ0V4cCA9IC9cXFMrLS1cXFMrL2c7XG5cbiAgcHVibGljIHN0YXRpYyBwYXJzZShjbGFzc05hbWU6IENsYXNzTmFtZVR5cGUpOiBBcnJheTxzdHJpbmc+IHtcbiAgICBsZXQgcGFydHM6IEFycmF5PHN0cmluZz4gPSBbXTtcblxuICAgIHBhcnRzID0gQmVtUGFyc2VyLmdldFBhcnRzKGNsYXNzTmFtZSwgcGFydHMsIEJlbVBhcnNlci5pc0JlbUJsb2NrKGNsYXNzTmFtZSksIEJlbVBhcnNlci5nZXRCbG9ja1BhcmFtKTtcbiAgICBwYXJ0cyA9IEJlbVBhcnNlci5nZXRQYXJ0cyhjbGFzc05hbWUsIHBhcnRzLCBCZW1QYXJzZXIuaXNCZW1Nb2RpZmllcihjbGFzc05hbWUpLCBCZW1QYXJzZXIuZ2V0TW9kaWZpZXJQYXJhbSk7XG5cbiAgICByZXR1cm4gcGFydHM7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGlzQmVtQmxvY2soY2xhc3NOYW1lOiBDbGFzc05hbWVUeXBlKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICEhY2xhc3NOYW1lLm1hdGNoKEJlbVBhcnNlci5CTE9DS19QQVRURVJOKTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgaXNCZW1Nb2RpZmllcihjbGFzc05hbWU6IENsYXNzTmFtZVR5cGUpOiBib29sZWFuIHtcbiAgICByZXR1cm4gISFjbGFzc05hbWUubWF0Y2goQmVtUGFyc2VyLk1PRElGSUVSX1BBVFRFUk4pO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgZ2V0UGFydHMoXG4gICAgY2xhc3NOYW1lOiBDbGFzc05hbWVUeXBlLFxuICAgIHNob3VsZEJlUGFydE9mOiBBcnJheTxzdHJpbmc+LFxuICAgIGJlbVR5cGU6IGJvb2xlYW4sXG4gICAgZ2V0UGFyYW06IEZ1bmN0aW9uLFxuICApOiBBcnJheTxzdHJpbmc+IHtcbiAgICBpZiAoIWJlbVR5cGUpIHtcbiAgICAgIHJldHVybiBzaG91bGRCZVBhcnRPZjtcbiAgICB9XG5cbiAgICBjb25zdCBwYXJ0czogQXJyYXk8c3RyaW5nPiA9IGNsYXNzTmFtZS5zcGxpdCgnLicpLmZpbHRlcihCb29sZWFuKTtcblxuICAgIHBhcnRzLmZvckVhY2goKHBhcnQpID0+IHtcbiAgICAgIHBhcnQgPSBnZXRQYXJhbShwYXJ0KTtcblxuICAgICAgaWYgKHBhcnQgJiYgIXNob3VsZEJlUGFydE9mLmluY2x1ZGVzKHBhcnQpKSB7XG4gICAgICAgIHNob3VsZEJlUGFydE9mLnB1c2gocGFydCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gc2hvdWxkQmVQYXJ0T2Y7XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBnZXRCbG9ja1BhcmFtKGNsYXNzTmFtZTogQ2xhc3NOYW1lVHlwZSk6IHN0cmluZyB7XG4gICAgY29uc3QgYmxvY2tQYXR0ZXJuOiBSZWdFeHAgPSAvXFxTKz8oPz1fXykvZztcblxuICAgIHJldHVybiBjbGFzc05hbWUubWF0Y2goYmxvY2tQYXR0ZXJuKSAmJiAnLicgKyBjbGFzc05hbWUubWF0Y2goYmxvY2tQYXR0ZXJuKVswXSArICcgKic7XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBnZXRNb2RpZmllclBhcmFtKGNsYXNzTmFtZTogQ2xhc3NOYW1lVHlwZSk6IHN0cmluZyB7XG4gICAgY29uc3QgbW9kaWZpZXJQYXR0ZXJuOiBSZWdFeHAgPSAvXFxTKz8oPz0tLSkvZztcblxuICAgIHJldHVybiBjbGFzc05hbWUubWF0Y2gobW9kaWZpZXJQYXR0ZXJuKSAmJiAnLicgKyBjbGFzc05hbWUubWF0Y2gobW9kaWZpZXJQYXR0ZXJuKVswXTtcbiAgfVxufVxuIiwiaW1wb3J0IFJ1bGVzUmVzb2x2ZXIgZnJvbSAnLi9SdWxlc1Jlc29sdmVyJztcbmltcG9ydCB7IFJ1bGUsIFN0eWxlc2hlZXQgfSBmcm9tICdjc3MnO1xuaW1wb3J0IHsgTWVkaWFRdWVyeUludGVyZmFjZSB9IGZyb20gJy4vTWVkaWFRdWVyeUludGVyZmFjZSc7XG5pbXBvcnQgeyBsaW50LCBMaW50UnVsZVR5cGUgfSBmcm9tICcuL2xpbnQnO1xuXG5jb25zdCBwcm9jZXNzID0gKGN0eDogU3R5bGVzaGVldCk6IEFycmF5PFJ1bGUgfCBNZWRpYVF1ZXJ5SW50ZXJmYWNlPiA9PiB7XG4gIHJldHVybiBuZXcgUnVsZXNSZXNvbHZlcihjdHguc3R5bGVzaGVldC5ydWxlcykucmVzb2x2ZSgpO1xufTtcblxuZXhwb3J0IGNvbnN0IHByZXByb2Nlc3M6IEZ1bmN0aW9uID0gKGN0eDogU3R5bGVzaGVldCwgbmV4dDogRnVuY3Rpb24pOiBGdW5jdGlvbiA9PiB7XG4gIGN0eC5zdHlsZXNoZWV0LnJ1bGVzID0gcHJvY2VzcyhjdHgpO1xuXG4gIHJldHVybiBuZXh0KCk7XG59O1xuXG5leHBvcnQgY29uc3QgcHJvY2Vzc0xpbnQgPSAoXG4gIGN0eDogU3R5bGVzaGVldCxcbik6IHsgcnVsZXM6IEFycmF5PExpbnRSdWxlVHlwZT47IGlzVmFsaWQ6IGJvb2xlYW47IGlzQmVtRGV0ZWN0ZWQ6IGJvb2xlYW4gfSA9PiB7XG4gIGN0eC5zdHlsZXNoZWV0LnJ1bGVzID0gcHJvY2VzcyhjdHgpO1xuXG4gIHJldHVybiBsaW50KGN0eCk7XG59O1xuXG5leHBvcnQgY29uc3QgbmFtZTogc3RyaW5nID0gJ0JFTSc7XG4iLCJpbXBvcnQgQmVtUGFyc2VyIGZyb20gJy4vQmVtUGFyc2VyJztcbmltcG9ydCB7IE1lZGlhUXVlcnlJbnRlcmZhY2UgfSBmcm9tICcuL01lZGlhUXVlcnlJbnRlcmZhY2UnO1xuaW1wb3J0IHsgQXRSdWxlLCBDb21tZW50LCBSdWxlIH0gZnJvbSAnY3NzJztcbmltcG9ydCB7IFNlbGVjdG9yVHlwZSB9IGZyb20gJy4vbGludCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgWHNob3VsZERlY2xhcmF0aW9uSW50ZXJmYWNlIHtcbiAgdHlwZTogc3RyaW5nO1xuICBwcm9wZXJ0eTogc3RyaW5nO1xuICB2YWx1ZTogc3RyaW5nO1xufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSdWxlc1Jlc29sdmVyIHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSBydWxlczogQXJyYXk8UnVsZSB8IENvbW1lbnQgfCBBdFJ1bGU+KSB7fVxuXG4gIHB1YmxpYyByZXNvbHZlKCk6IEFycmF5PFJ1bGUgfCBNZWRpYVF1ZXJ5SW50ZXJmYWNlPiB7XG4gICAgbGV0IHJlc3VsdDogQXJyYXk8UnVsZSB8IE1lZGlhUXVlcnlJbnRlcmZhY2U+ID0gW107XG5cbiAgICB0aGlzLnJ1bGVzLmZvckVhY2goXG4gICAgICAocnVsZTogYW55KTogdm9pZCA9PiB7XG4gICAgICAgIGlmIChSdWxlc1Jlc29sdmVyLmlzTm90TWVkaWFRdWVyeShydWxlKSAmJiBSdWxlc1Jlc29sdmVyLmlzUnVsZShydWxlKSkge1xuICAgICAgICAgIGxldCBydWxlcyA9IHRoaXMuZmxhdHRlblJ1bGVzKFtydWxlXSk7XG5cbiAgICAgICAgICBydWxlcy5tYXAoKHJ1bGUpID0+IHtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKHRoaXMuZ2V0UnVsZVdpdGhCZW1EZWNsYXJhdGlvbnMocnVsZSkpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgcnVsZS5ydWxlcyA9IHRoaXMuZmxhdHRlblJ1bGVzKHJ1bGUucnVsZXMpO1xuXG4gICAgICAgIHJ1bGUucnVsZXMgPSBydWxlLnJ1bGVzLm1hcCgocnVsZSkgPT4ge1xuICAgICAgICAgIHJldHVybiB0aGlzLmdldFJ1bGVXaXRoQmVtRGVjbGFyYXRpb25zKHJ1bGUpO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXN1bHQucHVzaChydWxlKTtcbiAgICAgIH0sXG4gICAgKTtcblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBwcml2YXRlIGZsYXR0ZW5SdWxlcyhydWxlczogQXJyYXk8UnVsZT4pOiBBcnJheTxSdWxlPiB7XG4gICAgbGV0IHJlc3VsdHM6IEFycmF5PFJ1bGU+ID0gW107XG5cbiAgICBpZiAoIXJ1bGVzKSB7XG4gICAgICByZXR1cm4gcmVzdWx0cztcbiAgICB9XG5cbiAgICBydWxlcy5mb3JFYWNoKFxuICAgICAgKHJ1bGUpOiB2b2lkID0+IHtcbiAgICAgICAgaWYgKCFydWxlLnNlbGVjdG9ycykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJ1bGUuc2VsZWN0b3JzLmZvckVhY2goXG4gICAgICAgICAgKHNlbGVjdG9yKTogdm9pZCA9PiB7XG4gICAgICAgICAgICBjb25zdCBuZXdSdWxlOiBSdWxlID0ge1xuICAgICAgICAgICAgICB0eXBlOiBydWxlLnR5cGUsXG4gICAgICAgICAgICAgIHNlbGVjdG9yczogW3NlbGVjdG9yXSxcbiAgICAgICAgICAgICAgZGVjbGFyYXRpb25zOiBydWxlLmRlY2xhcmF0aW9ucyxcbiAgICAgICAgICAgICAgcG9zaXRpb246IHJ1bGUucG9zaXRpb24sXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICByZXN1bHRzLnB1c2gobmV3UnVsZSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgKTtcbiAgICAgIH0sXG4gICAgKTtcblxuICAgIHJldHVybiByZXN1bHRzO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgaXNOb3RNZWRpYVF1ZXJ5KHJ1bGU6IE1lZGlhUXVlcnlJbnRlcmZhY2UgfCBSdWxlKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHJ1bGUudHlwZSAhPT0gJ21lZGlhJztcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGlzUnVsZShydWxlOiBNZWRpYVF1ZXJ5SW50ZXJmYWNlIHwgUnVsZSk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBydWxlLnR5cGUgPT09ICdydWxlJztcbiAgfVxuXG4gIHByaXZhdGUgZ2V0UnVsZVdpdGhCZW1EZWNsYXJhdGlvbnMocnVsZTogUnVsZSk6IFJ1bGUge1xuICAgIGNvbnN0IHNlbGVjdG9yc1dpdGhDc3NDbGFzczogQXJyYXk8c3RyaW5nPiA9IFtdO1xuXG4gICAgcnVsZS5zZWxlY3RvcnMuZm9yRWFjaChcbiAgICAgIChzZWxlY3Rvcik6IHZvaWQgPT4ge1xuICAgICAgICBpZiAoUnVsZXNSZXNvbHZlci5pc0Nzc0NsYXNzKHNlbGVjdG9yKSkge1xuICAgICAgICAgIHNlbGVjdG9yID0gUnVsZXNSZXNvbHZlci5nZXRMYXN0UGFydE9mQ3NzQ2xhc3Moc2VsZWN0b3IpO1xuICAgICAgICAgIHNlbGVjdG9yc1dpdGhDc3NDbGFzcy5wdXNoKHNlbGVjdG9yKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICApO1xuXG4gICAgaWYgKHNlbGVjdG9yc1dpdGhDc3NDbGFzcy5sZW5ndGggPCAxKSB7XG4gICAgICByZXR1cm4gcnVsZTtcbiAgICB9XG5cbiAgICBsZXQgcGFyYW1zOiBBcnJheTxzdHJpbmc+ID0gQmVtUGFyc2VyLnBhcnNlKHNlbGVjdG9yc1dpdGhDc3NDbGFzc1swXSk7XG5cbiAgICBwYXJhbXMgPSBSdWxlc1Jlc29sdmVyLnJlbW92ZUludmFsaWRNYXRjaGVzKHBhcmFtcyk7XG5cbiAgICBpZiAoIXBhcmFtcykge1xuICAgICAgcmV0dXJuIHJ1bGU7XG4gICAgfVxuXG4gICAgcnVsZS5kZWNsYXJhdGlvbnMgPSBydWxlLmRlY2xhcmF0aW9ucy5jb25jYXQoXG4gICAgICBwYXJhbXMubWFwKFxuICAgICAgICAocGFyYW0pOiBYc2hvdWxkRGVjbGFyYXRpb25JbnRlcmZhY2UgPT4ge1xuICAgICAgICAgIHJldHVybiB7IHR5cGU6ICdkZWNsYXJhdGlvbicsIHByb3BlcnR5OiAneC1zaG91bGQnLCB2YWx1ZTogYG1hdGNoICcke3BhcmFtfSdgIH07XG4gICAgICAgIH0sXG4gICAgICApLFxuICAgICk7XG5cbiAgICByZXR1cm4gcnVsZTtcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGlzQ3NzQ2xhc3Moc2VsZWN0b3I6IFNlbGVjdG9yVHlwZSk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IHBhdHRlcm46IFJlZ0V4cCA9IC8oXFwuXFxTKykvZztcblxuICAgIHJldHVybiAhIXNlbGVjdG9yLm1hdGNoKHBhdHRlcm4pO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgcmVtb3ZlSW52YWxpZE1hdGNoZXMobWF0Y2hlczogQXJyYXk8c3RyaW5nPik6IEFycmF5PHN0cmluZz4ge1xuICAgIHJldHVybiBtYXRjaGVzLmZpbHRlcigobWF0Y2gpID0+ICFtYXRjaC5tYXRjaCgvXFxbLisvZykpO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgZ2V0TGFzdFBhcnRPZkNzc0NsYXNzKHNlbGVjdG9yOiBTZWxlY3RvclR5cGUpOiBzdHJpbmcge1xuICAgIGNvbnN0IHBhcnRzOiBBcnJheTxzdHJpbmc+ID0gc2VsZWN0b3Iuc3BsaXQoJy4nKS5maWx0ZXIoQm9vbGVhbik7XG5cbiAgICByZXR1cm4gJy4nICsgcGFydHMucG9wKCk7XG4gIH1cbn1cbiIsImltcG9ydCB7IE1lZGlhLCBSdWxlLCBTdHlsZXNoZWV0IH0gZnJvbSAnY3NzJztcbmltcG9ydCB7IFhzaG91bGREZWNsYXJhdGlvbkludGVyZmFjZSB9IGZyb20gJy4vUnVsZXNSZXNvbHZlcic7XG5pbXBvcnQgQmVtUGFyc2VyIGZyb20gJy4vQmVtUGFyc2VyJztcblxuZXhwb3J0IHR5cGUgQ2xhc3NOYW1lVHlwZSA9IHN0cmluZztcbnR5cGUgQ2xhc3NOYW1lc1R5cGUgPSBBcnJheTxDbGFzc05hbWVUeXBlPjtcbmV4cG9ydCB0eXBlIFNlbGVjdG9yVHlwZSA9IHN0cmluZztcbnR5cGUgU2VsZWN0b3JzVHlwZSA9IEFycmF5PFNlbGVjdG9yVHlwZT47XG5leHBvcnQgdHlwZSBMaW50UnVsZVR5cGUgPSB7IG1pc3NpbmdDbGFzc05hbWU6IENsYXNzTmFtZVR5cGU7IHNlbGVjdG9yOiBTZWxlY3RvclR5cGUgfTtcblxuZXhwb3J0IGNvbnN0IGxpbnQgPSAoY3NzOiBTdHlsZXNoZWV0KTogeyBydWxlczogQXJyYXk8TGludFJ1bGVUeXBlPjsgaXNWYWxpZDogYm9vbGVhbjsgaXNCZW1EZXRlY3RlZDogYm9vbGVhbiB9ID0+IHtcbiAgY29uc3QgeyBydWxlcywgaXNCZW1EZXRlY3RlZCB9ID0gZ2V0SW52YWxpZFJ1bGVzKGNzcyk7XG5cbiAgcmV0dXJuIHtcbiAgICBydWxlczogcnVsZXMubWFwKCh7IHJ1bGUsIGNsYXNzTmFtZSB9KSA9PiAoe1xuICAgICAgbWlzc2luZ0NsYXNzTmFtZTogY2xhc3NOYW1lLFxuICAgICAgc2VsZWN0b3I6IHJ1bGUuc2VsZWN0b3JzWzBdIHx8ICcnLFxuICAgIH0pKSxcbiAgICBpc1ZhbGlkOiBpc0JlbURldGVjdGVkICYmIHJ1bGVzLmxlbmd0aCA9PT0gMCxcbiAgICBpc0JlbURldGVjdGVkLFxuICB9O1xufTtcblxuY29uc3QgZ2V0SW52YWxpZFJ1bGVzID0gKFxuICBjc3M6IFN0eWxlc2hlZXQsXG4pOiB7IHJ1bGVzOiBBcnJheTx7IGNsYXNzTmFtZTogQ2xhc3NOYW1lVHlwZTsgcnVsZTogUnVsZSB9PjsgaXNCZW1EZXRlY3RlZDogYm9vbGVhbiB9ID0+IHtcbiAgbGV0IGludmFsaWRSdWxlcyA9IFtdO1xuICBsZXQgaW52YWxpZENsYXNzTmFtZXMgPSBbXTtcbiAgbGV0IHNlbGVjdG9ycyA9IFtdO1xuICBsZXQgYmVtU2VsZWN0b3JzID0gW107XG5cbiAgY3NzLnN0eWxlc2hlZXQucnVsZXMuZm9yRWFjaCgocnVsZTogUnVsZSAmIE1lZGlhKSA9PiB7XG4gICAgZGV0ZWN0TWlzc2luZ0NsYXNzZXMocnVsZSwgaW52YWxpZFJ1bGVzLCBpbnZhbGlkQ2xhc3NOYW1lcywgc2VsZWN0b3JzLCBiZW1TZWxlY3RvcnMpO1xuXG4gICAgaWYgKHJ1bGUudHlwZSA9PT0gJ21lZGlhJykge1xuICAgICAgcnVsZS5ydWxlcy5mb3JFYWNoKChydWxlOiBSdWxlKSA9PiB7XG4gICAgICAgIGRldGVjdE1pc3NpbmdDbGFzc2VzKHJ1bGUsIGludmFsaWRSdWxlcywgaW52YWxpZENsYXNzTmFtZXMsIHNlbGVjdG9ycywgYmVtU2VsZWN0b3JzKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIHsgcnVsZXM6IFsuLi5uZXcgU2V0KGludmFsaWRSdWxlcyldLCBpc0JlbURldGVjdGVkOiBiZW1TZWxlY3RvcnMubGVuZ3RoID4gMCB9O1xufTtcblxuY29uc3QgaXNDbGFzc05hbWVFeGlzdEluQ29sbGVjdGlvbiA9IChcbiAgaW52YWxpZENsYXNzTmFtZXM6IENsYXNzTmFtZXNUeXBlLFxuICBzZWxlY3RvcnM6IFNlbGVjdG9yc1R5cGUsXG4gIGNsYXNzTmFtZTogQ2xhc3NOYW1lVHlwZSxcbik6IGJvb2xlYW4gPT4gc2VsZWN0b3JzLmluY2x1ZGVzKGNsYXNzTmFtZSk7XG5cbmNvbnN0IGRldGVjdE1pc3NpbmdDbGFzc2VzID0gKFxuICBydWxlOiBSdWxlLFxuICBpbnZhbGlkUnVsZXM6IEFycmF5PE9iamVjdD4sXG4gIGludmFsaWRDbGFzc05hbWVzOiBDbGFzc05hbWVzVHlwZSxcbiAgc2VsZWN0b3JzOiBTZWxlY3RvcnNUeXBlLFxuICBiZW1TZWxlY3RvcnM6IFNlbGVjdG9yc1R5cGUsXG4pID0+IHtcbiAgaWYgKHJ1bGUudHlwZSA9PT0gJ3J1bGUnKSB7XG4gICAgY29uc3Qgc2VsZWN0b3IgPSBydWxlLnNlbGVjdG9yc1swXTtcblxuICAgIGNvbnN0IGFsbFNlbGVjdG9yczogQXJyYXk8c3RyaW5nPiA9IFtcbiAgICAgIC4uLm5ldyBTZXQoXG4gICAgICAgIFtdXG4gICAgICAgICAgLmNvbmNhdCguLi5zZWxlY3Rvci5zcGxpdCgnLicpKVxuICAgICAgICAgIC5maWx0ZXIoKGNsYXNzTmFtZSkgPT4gY2xhc3NOYW1lKVxuICAgICAgICAgIC5tYXAoKGNsYXNzTmFtZSkgPT4gYC4ke2NsYXNzTmFtZX1gKSxcbiAgICAgICksXG4gICAgXTtcbiAgICBzZWxlY3RvcnMucHVzaCguLi5hbGxTZWxlY3RvcnMpO1xuXG4gICAgcnVsZS5kZWNsYXJhdGlvbnMuZm9yRWFjaCgoZGVjbGFyYXRpb246IFhzaG91bGREZWNsYXJhdGlvbkludGVyZmFjZSkgPT4ge1xuICAgICAgaWYgKGRlY2xhcmF0aW9uLnByb3BlcnR5ID09PSAneC1zaG91bGQnKSB7XG4gICAgICAgIGJlbVNlbGVjdG9ycy5wdXNoKHNlbGVjdG9yKTtcbiAgICAgICAgY29uc3QgcnVsZURlY2xhcmF0aW9uOiBSZWdFeHBNYXRjaEFycmF5ID0gZGVjbGFyYXRpb24udmFsdWUubWF0Y2goLyg/PVxcLikoLiopKD89JykvZyk7XG4gICAgICAgIGNvbnN0IGNsYXNzTmFtZXNEZWNsYXJhdGlvbjogUmVnRXhwTWF0Y2hBcnJheSA9IHJ1bGVEZWNsYXJhdGlvblswXS5tYXRjaCgvKFxcLlxcUyspL2cpO1xuXG4gICAgICAgIGNvbnN0IGNsYXNzTmFtZSA9IGNsYXNzTmFtZXNEZWNsYXJhdGlvblswXTtcblxuICAgICAgICBpZiAoaXNDbGFzc05hbWVFeGlzdEluQ29sbGVjdGlvbihpbnZhbGlkQ2xhc3NOYW1lcywgc2VsZWN0b3JzLCBjbGFzc05hbWUpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKEJlbVBhcnNlci5pc0JlbU1vZGlmaWVyKHNlbGVjdG9yKSAmJiBCZW1QYXJzZXIuaXNCZW1CbG9jayhjbGFzc05hbWUpKSB7XG4gICAgICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGNsYXNzTmFtZSwgJ2cnKTtcbiAgICAgICAgICBjb25zdCBtYXRjaGVkID0gc2VsZWN0b3IubWF0Y2gocmVnZXgpO1xuXG4gICAgICAgICAgaWYgKG1hdGNoZWQubGVuZ3RoIDw9IDEpIHtcbiAgICAgICAgICAgIGludmFsaWRDbGFzc05hbWVzLnB1c2goY2xhc3NOYW1lKTtcbiAgICAgICAgICAgIGludmFsaWRSdWxlcy5wdXNoKHsgY2xhc3NOYW1lLCBydWxlIH0pO1xuXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKEJlbVBhcnNlci5pc0JlbUJsb2NrKHNlbGVjdG9yKSAmJiAhQmVtUGFyc2VyLmlzQmVtTW9kaWZpZXIoY2xhc3NOYW1lKSAmJiAhQmVtUGFyc2VyLmlzQmVtQmxvY2soY2xhc3NOYW1lKSkge1xuICAgICAgICAgIGludmFsaWRDbGFzc05hbWVzLnB1c2goY2xhc3NOYW1lKTtcbiAgICAgICAgICBpbnZhbGlkUnVsZXMucHVzaCh7IGNsYXNzTmFtZSwgcnVsZSB9KTtcblxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChCZW1QYXJzZXIuaXNCZW1Nb2RpZmllcihzZWxlY3RvcikpIHtcbiAgICAgICAgICBpbnZhbGlkQ2xhc3NOYW1lcy5wdXNoKGNsYXNzTmFtZSk7XG4gICAgICAgICAgaW52YWxpZFJ1bGVzLnB1c2goeyBjbGFzc05hbWUsIHJ1bGUgfSk7XG5cbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufTtcbiJdLCJzb3VyY2VSb290IjoiIn0=